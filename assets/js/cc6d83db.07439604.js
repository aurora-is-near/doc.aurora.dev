"use strict";(self.webpackChunkaurora_docs=self.webpackChunkaurora_docs||[]).push([[2262],{8615:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var a=n(9907),r=n(3274),s=n(7507);const o={title:"How to get NEAR transaction from the Aurora\u2019s one?",description:"Let's find out how to dig into Aurora transactions and get the underlying NEAR data",date:"2023-03-30",authors:["slava"],tags:["tips_and_tricks"],image:"https://www.datocms-assets.com/95026/1682082350-na-article-cover.png"},i=void 0,c={authorsImageUrls:[void 0]},d=[{value:"Aurora Helpers",id:"aurora-helpers",level:3},{value:"NEAR Receipt: Hex",id:"near-receipt-hex",level:3},{value:"NEAR Receipt: Base58",id:"near-receipt-base58",level:3},{value:"NEAR Tx Hash: Using Explorer",id:"near-tx-hash-using-explorer",level:3},{value:"NEAR Tx Hash: Using Code",id:"near-tx-hash-using-code",level:3},{value:"Conclusion",id:"conclusion",level:3}];function l(e){const t={a:"a",br:"br",code:"code",em:"em",h3:"h3",img:"img",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.p,{children:["In this ",(0,r.jsx)(t.em,{children:"Tips & Tricks"})," article, we will learn how to get a NEAR transaction hash by having the Aurora transaction's one."]}),"\n",(0,r.jsxs)(t.p,{children:["Let's consider some random Aurora transaction for our tests, like this one: ",(0,r.jsx)(t.code,{children:"0x36e2339784004c5dd40df74e663f1fe6683705a8ad665a05a9ad0aa4e11b559b"}),(0,r.jsx)(t.em,{children:"."})]}),"\n",(0,r.jsx)(t.h3,{id:"aurora-helpers",children:"Aurora Helpers"}),"\n",(0,r.jsxs)(t.p,{children:["If you\u2019re not interested in the code-solution, you can take a shortcut and use ",(0,r.jsx)(t.a,{href:"https://aurora-helpers.vercel.app/aurora_to_near",children:(0,r.jsx)(t.em,{children:"Aurora Helpers dApp"})}),". Go there, paste Aurora\u2019s hash \u2013 and you\u2019ll get the result, e.g., for our test transaction, the result will be:"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://www.datocms-assets.com/95026/1679324662-screenshot-2023-03-20-at-15-03-32.png",alt:""})}),"\n",(0,r.jsx)(t.h3,{id:"near-receipt-hex",children:"NEAR Receipt: Hex"}),"\n",(0,r.jsx)(t.p,{children:"As developers, we\u2019re eager to know how to get all that information in our code directly without using any third parties. So let\u2019s disentangle that and find out how Aurora Helpers work underneath."}),"\n",(0,r.jsxs)(t.p,{children:["First of all, let\u2019s configure our ",(0,r.jsx)(t.a,{href:"https://web3js.readthedocs.io/en/v1.8.2/",children:(0,r.jsx)(t.em,{children:"web3.js"})})," provider to be Aurora's mainnet endpoint and set ",(0,r.jsx)(t.code,{children:"tx"})," variable:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",children:"const mainnet = 'https://mainnet.aurora.dev';\nconst web3 = new Web3(new Web3.providers.HttpProvider(mainnet));\n\nconst tx = 0x36e2339784004c5dd40df74e663f1fe6683705a8ad665a05a9ad0aa4e11b559b;\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Now, we can get the NEAR transaction receipt by getting Aurora transaction receipt information with the ",(0,r.jsx)(t.a,{href:"https://ethereum.org/en/developers/docs/apis/json-rpc/#eth_gettransactionreceipt",children:"`eth_getTransactionReceipt`"})," EVM call:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",children:"const getNearReceipt = async () => {\n    const res = await web3.eth.getTransactionReceipt(tx);\n    return res.nearReceiptHash;\n};\n"})}),"\n",(0,r.jsxs)(t.p,{children:["By calling it, you will get the ",(0,r.jsx)(t.code,{children:"hex-encoded"})," hash of the NEAR transaction receipt:"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.code,{children:"0x583237e9ef4d449cd828ff19668baa581a5532591058d3a886af65b80df7e938"})}),"\n",(0,r.jsx)(t.h3,{id:"near-receipt-base58",children:"NEAR Receipt: Base58"}),"\n",(0,r.jsxs)(t.p,{children:["But NEAR hashes should be ",(0,r.jsx)(t.code,{children:"base58"})," encoded! And that is what we need to do next \u2013 let's add the ",(0,r.jsx)(t.code,{children:"bs58"})," library and convert it:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",children:"const bs58 = require('bs58');\nconst getNearReceiptBase58 = async () => {\n   const receipt = await getNearReceipt();\n   bufferHex = Buffer.from(receipt.slice(2), \"hex\");\n   nearReceiptBase58 = bs58.encode(bufferHex);\n   return nearReceiptBase58;\n};\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Then, by calling ",(0,r.jsx)(t.code,{children:"getNearReceiptBase58"})," and outputting result to the console, like this: ",(0,r.jsx)(t.code,{children:"getNearReceiptBase58().then(console.log)"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["You'll get this result: ",(0,r.jsx)(t.code,{children:"6wHHsKvNz2uaEaTyuqTDtLdhChQNtPXSfYJQYu7LrxFy"}),"."]}),"\n",(0,r.jsx)(t.h3,{id:"near-tx-hash-using-explorer",children:"NEAR Tx Hash: Using Explorer"}),"\n",(0,r.jsx)(t.p,{children:"At this point, you can go to the NEAR Explorer, enter the receipt, and get your transaction information:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://www.datocms-assets.com/95026/1679325885-screenshot-2023-03-20-at-15-24-17.png",alt:""})}),"\n",(0,r.jsx)(t.p,{children:"You can check that this is the correct transaction by scrolling down and seeing the corresponding receipt hash in the Transaction Execution Plan section:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://www.datocms-assets.com/95026/1679325931-screenshot-2023-03-20-at-15-24-31.png",alt:""})}),"\n",(0,r.jsx)(t.h3,{id:"near-tx-hash-using-code",children:"NEAR Tx Hash: Using Code"}),"\n",(0,r.jsxs)(t.p,{children:["But wait \u2013 we want to code this! How do we do it? No problem \u2013 we can get a NEAR transaction by sending a call to the NEAR Explorer endpoint with the receipt hash in it. Let's use a promise-based HTTP client called ",(0,r.jsx)(t.a,{href:"https://axios-http.com/docs/intro",children:"Axios"})," for doing this:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",children:"const axios = require('axios');\nconst nearExplorerEndpoint = 'https://backend-mainnet-1713.onrender.com/trpc/utils.search?batch=1';\nconst getNearTxHash = async () => {\n   const nearReceipt = await getNearReceiptBase58();\n   const payload = {\n       0: {\n         value: nearReceipt,\n       },\n   }\n   const response = await axios.post(nearExplorerEndpoint, payload);\n   const transactionHash = response?.data[0]?.result?.data?.transactionHash;\n   return transactionHash;\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:"As you can see, you need to dig into the response result a little bit (in line 11), but we have already done that for you. By running this last script, you will get the final result which is:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.code,{children:"7e5nRG8bYkJt1xRgBC38Veh2sA3fDrdepvPxHckojnut"})}),"\n",(0,r.jsx)(t.h3,{id:"conclusion",children:"Conclusion"}),"\n",(0,r.jsx)(t.p,{children:"We've discovered today how to convert Aurora transactions into the corresponding NEAR transactions in 3 different ways (AuroraHelpers, Code+Explorer, Plain Code)."}),"\n",(0,r.jsxs)(t.p,{children:["By retrieving a NEAR transaction hash, you can now access all of the associated NEAR information behind it. It could be useful, for example, to understand how an Aurora Rainbow Bridge transaction or Aurora Engine works underneath. But that is the matter for the future articles to come!",(0,r.jsx)(t.br,{}),"\n",(0,r.jsx)(t.br,{}),"\n","I hope you have enjoyed this short tutorial! Leave any questions or comments below. See you next time!"]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},7507:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var a=n(9474);const r={},s=a.createContext(r);function o(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(s.Provider,{value:t},e.children)}},9907:e=>{e.exports=JSON.parse('{"permalink":"/blog/convert-aurora-transaction-into-near-s-one","editUrl":"https://github.com/aurora-is-near/doc.aurora.dev/edit/master/blog/convert-aurora-transaction-into-near-s-one.md","source":"@site/blog/convert-aurora-transaction-into-near-s-one.md","title":"How to get NEAR transaction from the Aurora\u2019s one?","description":"Let\'s find out how to dig into Aurora transactions and get the underlying NEAR data","date":"2023-03-30T00:00:00.000Z","tags":[{"inline":false,"label":"Tips & Tricks","permalink":"/blog/tags/tips_and_tricks","description":"Short posts about tech for devs on Aurora"}],"readingTime":1.8466666666666667,"hasTruncateMarker":true,"authors":[{"name":"Slava Karkunov","title":"DevRel","socials":{"x":"https://x.com/apocnab","github":"https://github.com/karkunow","linkedin":"https://www.linkedin.com/in/karkunov/"},"imageURL":"https://www.datocms-assets.com/95026/1677167398-photo_2022-12-02-14-55-03.jpeg","key":"slava","page":null}],"frontMatter":{"title":"How to get NEAR transaction from the Aurora\u2019s one?","description":"Let\'s find out how to dig into Aurora transactions and get the underlying NEAR data","date":"2023-03-30","authors":["slava"],"tags":["tips_and_tricks"],"image":"https://www.datocms-assets.com/95026/1682082350-na-article-cover.png"},"unlisted":false,"prevItem":{"title":"How the Aurora Relayer 2.0 works?","permalink":"/blog/aurora-relayer-2-0"},"nextItem":{"title":"Demystifying Transaction Failures","permalink":"/blog/demystifying-transaction-failures"}}')}}]);