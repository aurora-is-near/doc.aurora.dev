{
    "version": "https://jsonfeed.org/version/1",
    "title": "Aurora Documentation Blog",
    "home_page_url": "https://doc.aurora.dev/blog",
    "description": "Aurora Documentation Blog",
    "items": [
        {
            "id": "https://doc.aurora.dev/blog/create-virtual-chain",
            "content_html": "<p>In this short tutorial we will show how by using <a href=\"https://docs.near.org/chain-abstraction/omnibridge/overview\" target=\"_blank\" rel=\"noopener noreferrer\">Omnibridge</a> and <a href=\"https://app.auroracloud.dev/auth/login\" target=\"_blank\" rel=\"noopener noreferrer\">AuroraCloud</a>, you can start your own EVM chain with a custom token from other chains (e.g., Solana, Base, Ethereum).</p>\n<p>To do this we will create a custom token, bridge it to NEAR and use corresponding fungible token (NEP-141 on NEAR) as a gas token for a virtual chain.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"quick-plan\">Quick plan<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#quick-plan\" class=\"hash-link\" aria-label=\"Direct link to Quick plan\" title=\"Direct link to Quick plan\">​</a></h2>\n<p>In the previous articles:</p>\n<ul>\n<li><a href=\"https://doc.aurora.dev/blog/thirdweb-erc20\">Launching your base token using thirdweb</a></li>\n<li><a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial\">Bridge-CLI: moving tokens with Omni Bridge</a></li>\n</ul>\n<p>We have:</p>\n<ol>\n<li>Created a custom token on Base.</li>\n<li>Deployed that token via Omnibridge to NEAR -&gt; get NEP-141 token there.</li>\n<li>Deployed your virtual chain using that NEP-141 token.</li>\n<li>Bridged your tokens from Base to NEAR.</li>\n</ol>\n<p>So we will talk about the previous steps very briefly, and focus more on the next steps:</p>\n<ol>\n<li>Deploy your virtual chain with that base token.</li>\n<li>Bridge your tokens from NEAR inside your virtual chain.</li>\n<li>Execute a transfer and pay gas fees in that token.</li>\n<li>Collect the EVM gas to your NEAR wallet</li>\n</ol>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"requirements\">Requirements<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#requirements\" class=\"hash-link\" aria-label=\"Direct link to Requirements\" title=\"Direct link to Requirements\">​</a></h2>\n<p>We're expecting you to have your <a href=\"https://metamask.io/faqs\" target=\"_blank\" rel=\"noopener noreferrer\">MetaMask installed</a> and your wallet already created there. You can use any other EVM wallet too. E.g., Rabby, Brave or Coinbase Wallet.</p>\n<p>Please also make sure you have a NEAR wallet to be used, you can create one at <a href=\"https://app.mynearwallet.com/\" target=\"_blank\" rel=\"noopener noreferrer\">MyNearWallet</a>.</p>\n<p>Get some real funds there to pay for gas and token deployments. We recommend using <a href=\"https://near-intents.org/\" target=\"_blank\" rel=\"noopener noreferrer\">NEAR Intents</a> to swap and bridge tokens between different chains.</p>\n<p>Please contact us on <a href=\"https://discord.gg/auroralabs\" target=\"_blank\" rel=\"noopener noreferrer\">Discord</a> if you will need any help with getting funds for gas fees.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"creating-a-base-token\">Creating a base token<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#creating-a-base-token\" class=\"hash-link\" aria-label=\"Direct link to Creating a base token\" title=\"Direct link to Creating a base token\">​</a></h2>\n<p>To create your base token we recommend next variants:</p>\n<ul>\n<li>Use <a href=\"https://thirdweb.com/login\" target=\"_blank\" rel=\"noopener noreferrer\">Thirdweb</a>. Here is <a href=\"https://doc.aurora.dev/blog/thirdweb-erc20\">a quick tutorial</a>.</li>\n<li>Use <a href=\"https://docs.openzeppelin.com/contracts/5.x/erc20\" target=\"_blank\" rel=\"noopener noreferrer\">OpenZeppelin</a> contracts.</li>\n<li>Or <a href=\"https://doc.aurora.dev/build-a-dapp/contracts/erc-20\">Aurora Contracts</a>.</li>\n<li>For Solana you can use <a href=\"https://www.solana-program.com/docs/token\" target=\"_blank\" rel=\"noopener noreferrer\"><code>spl-token</code> CLI tool</a>.</li>\n</ul>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"deploying-token-to-near\">Deploying token to NEAR<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#deploying-token-to-near\" class=\"hash-link\" aria-label=\"Direct link to Deploying token to NEAR\" title=\"Direct link to Deploying token to NEAR\">​</a></h2>\n<p>Now, you will need to use OmniBridge to bridge that base token to the NEAR Network.\nPlease, make it by following instructions in this <a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial\">blog article</a>.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"deploying-your-virtual-chain\">Deploying your virtual chain<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#deploying-your-virtual-chain\" class=\"hash-link\" aria-label=\"Direct link to Deploying your virtual chain\" title=\"Direct link to Deploying your virtual chain\">​</a></h2>\n<p>To deploy your chain you will need to:</p>\n<ol>\n<li>Create an account on <a href=\"https://app.auroracloud.dev/\" target=\"_blank\" rel=\"noopener noreferrer\">Aurora Cloud</a>.</li>\n<li>Log in into your account.</li>\n<li>Configure your chain setup.</li>\n<li>Deploy the chain.</li>\n</ol>\n<p>This video demonstrates how it is done in just 1 min:</p>\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/ChGraS1RSoc?si=V8n8YfgGMdR9VcsB\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\"></iframe>\n<p>Let's follow it step-by-step below, and also cover how to configure the custom base token.</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"create-account\">Create account<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#create-account\" class=\"hash-link\" aria-label=\"Direct link to Create account\" title=\"Direct link to Create account\">​</a></h3>\n<p>Go to <a href=\"https://app.auroracloud.dev/\" target=\"_blank\" rel=\"noopener noreferrer\">Aurora Cloud</a> website and click \"Sign In\" button:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"sign in button on aurora cloud website\" src=\"https://doc.aurora.dev/assets/images/acc_sign_in-1a6a6b20170f8f1a858526021b129558.png\" width=\"3826\" height=\"1940\" class=\"img__pfF\"></p>\n<p>Click \"Create account\" link if you do not have one:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"create account link on aurora cloud website\" src=\"https://doc.aurora.dev/assets/images/acc_create_account-33b972bc9103c5cd69ac269890c6dfc9.png\" width=\"3750\" height=\"1244\" class=\"img__pfF\"></p>\n<p>And fill the needed information here, create an account by clicking \"Sign Up\" button:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"create account form on aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_create_account_popup-754a7a649c98d38f142a970242dc9bd2.png\" width=\"3786\" height=\"1330\" class=\"img__pfF\"></p>\n<p>After that go to <a href=\"https://app.auroracloud.dev/auth/login\" target=\"_blank\" rel=\"noopener noreferrer\">\"Sign In\"</a> page and log in there, you will see the next screen after that:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"aurora cloud console chain configuration\" src=\"https://doc.aurora.dev/assets/images/acc_chain_config-32ad7f5e9b0eafeeb7d8fe1b1a5a5b4f.png\" width=\"3840\" height=\"1524\" class=\"img__pfF\"></p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"configure-your-chain\">Configure your chain<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#configure-your-chain\" class=\"hash-link\" aria-label=\"Direct link to Configure your chain\" title=\"Direct link to Configure your chain\">​</a></h3>\n<p>After clicking the \"Get started\" button on the screenshot above, you will see:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"chain configuration popup on aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_chain_config_popup-62065277ea74ce27628d25c54acdc890.png\" width=\"3804\" height=\"1928\" class=\"img__pfF\"></p>\n<p>Choose your chain permissions first. Usually the chain will have \"Public\" permissions, so just choose it.\nWith the \"Permissioned\" ones you will be able to block some people from deploying smart contracts or interacting with a chain. If needed, this could be easily changed in the future for any \"Public\" chain.</p>\n<p>Now, scroll a bit down. You will see Base Token selection, choose \"My Token\" to deploy your token created in the <a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial\">previous article</a>:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"base token selection dropdown in aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_chain_token-74793a0efee2c625dffe8e7af7cfeb09.png\" width=\"3330\" height=\"1278\" class=\"img__pfF\"></p>\n<div class=\"theme-admonition theme-admonition-note admonition_lH1X alert alert--secondary\"><div class=\"admonitionHeading_SPjx\"><span class=\"admonitionIcon_ghVV\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></span>note</div><div class=\"admonitionContent_RARr\"><p>Of course, you can use any of the already predefined tokens, as AURORA, ETH, USDC, BTC, etc. It will make the deployment faster. We're just covering the most general case here for the educational purposes.</p></div></div>\n<p>Enter your <a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#deploying-token-to-near-1\">token address</a> into the text input:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"base token address filled in aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_chain_token_filled-c1f914a220ed33b779c00113ad01cfa0.png\" width=\"2290\" height=\"1248\" class=\"img__pfF\"></p>\n<div class=\"theme-admonition theme-admonition-note admonition_lH1X alert alert--secondary\"><div class=\"admonitionHeading_SPjx\"><span class=\"admonitionIcon_ghVV\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></span>note</div><div class=\"admonitionContent_RARr\"><p>We're using <a href=\"https://nearblocks.io/address/base-0xf3dfcffc520811d76236892e88d112d2a4a69d0d.omdep.near\" target=\"_blank\" rel=\"noopener noreferrer\">this token</a> from the <a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial\">previous tutorial</a>.</p></div></div>\n<p>Add chain information, and click \"Save my chain configuration\" button:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"chain information form in aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_chain_info-a07c446fd2646a0161f7b2acc2a65afb.png\" width=\"3840\" height=\"1750\" class=\"img__pfF\"></p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"deploy-your-chain\">Deploy your chain<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#deploy-your-chain\" class=\"hash-link\" aria-label=\"Direct link to Deploy your chain\" title=\"Direct link to Deploy your chain\">​</a></h3>\n<p>Now, you're ready to deploy your chain, click \"Deploy now\" button and confirm all of the popups there:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"deploy now button in aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_chain_deployment_button-0d93da548f1b7a5ff722608ef0a0b5ce.png\" width=\"3834\" height=\"1484\" class=\"img__pfF\"></p>\n<p>After this we will receive an automatic notification about your chain deployment, and when we'll address it - you will get your chain working.</p>\n<div class=\"theme-admonition theme-admonition-info admonition_lH1X alert alert--info\"><div class=\"admonitionHeading_SPjx\"><span class=\"admonitionIcon_ghVV\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg></span>info</div><div class=\"admonitionContent_RARr\"><p>Note that we need to do some manual operations during the chain deployment only if you're using a custom base token. So, if you use some pre-defined token, it will automatic and ready in seconds to be used!</p></div></div>\n<p>When everything is ready, you will see:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"chain live status screen in aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_chain_live-e76157804a339578610a6f01c07cd202.png\" width=\"3810\" height=\"1730\" class=\"img__pfF\"></p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"chain-information\">Chain Information<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#chain-information\" class=\"hash-link\" aria-label=\"Direct link to Chain Information\" title=\"Direct link to Chain Information\">​</a></h3>\n<p>You can find all of the important information about your chain inside the \"Chain Settings\" tab located at the left sidebar:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"chain settings tab in aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_chain_settings-290101d02950e2b7f6f8eb168076e303.png\" width=\"3840\" height=\"1944\" class=\"img__pfF\"></p>\n<p>Let us describe some of these for you:</p>\n<ul>\n<li>Engine Account - is a NEAR smart contract realizing your EVM on NEAR. You can actually go and inspect it on <a href=\"https://nearblocks.io/address/0x4e454265.c.aurora\" target=\"_blank\" rel=\"noopener noreferrer\">NearBlocks</a>.</li>\n<li>RPC URL - <code>https://0x4e454265.rpc.aurora-cloud.dev</code> your blockchain node URL, to which you can point your wallets or developer environments.</li>\n<li>Explorer - <a href=\"https://0x4e454265.explorer.aurora-cloud.dev/\" target=\"_blank\" rel=\"noopener noreferrer\"><code>https://0x4e454265.explorer.aurora-cloud.dev</code></a> your Explorer URL, where you can inspect your EVM transactions.</li>\n</ul>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"adding-a-chain-to-your-wallet\">Adding a chain to your wallet<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#adding-a-chain-to-your-wallet\" class=\"hash-link\" aria-label=\"Direct link to Adding a chain to your wallet\" title=\"Direct link to Adding a chain to your wallet\">​</a></h3>\n<p>To add your chain to your MetaMask, just click the 'Add to MetaMask' button on \"Chain Settings\" page.</p>\n<p>You can find it at the \"Chain details\" section, right below the same-named label seen on the screenshot above.</p>\n<p>After that you will be able to see your gas token and erc-20 balances in your wallet:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"chain added to wallet screenshot\" src=\"https://doc.aurora.dev/assets/images/acc_chain_added-2109bffa91954d704f9ca6980493f9b0.png\" width=\"2018\" height=\"1384\" class=\"img__pfF\"></p>\n<p>As well as transaction history.</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"gas-management\">Gas management<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#gas-management\" class=\"hash-link\" aria-label=\"Direct link to Gas management\" title=\"Direct link to Gas management\">​</a></h3>\n<p>You can also examine the amount of the transactions supplied for your chain at \"Gas abstraction\" tab's section \"Gas consumed\":</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"gas abstraction tab showing gas consumed in aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_gas_txs-99ea0e21ce686ad67e21b01c9bdc1308.png\" width=\"3798\" height=\"1908\" class=\"img__pfF\"></p>\n<p>As you can see, you have 10 NEAR of balance on your Engine contract, which is equal to 10000 free transactions.</p>\n<p>The way the virtual chain works is that it pays for your EVM transactions on NEAR from the engine account while accumulating the EVM gas for you on its in-EVM account.</p>\n<p>You can see how much of the EVM gas your chain has accumulated in \"Gas collected\" section:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"gas collected section in aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_gas_accumulated-9a68d489b2e6eab220be1df3921de13b.png\" width=\"3834\" height=\"1890\" class=\"img__pfF\"></p>\n<p>You could also set your \"Gas collection address\" to withdraw that gas token to it later via clicking \"Collect\" button seen above.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"setting-the-gas-price\">Setting the gas price<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#setting-the-gas-price\" class=\"hash-link\" aria-label=\"Direct link to Setting the gas price\" title=\"Direct link to Setting the gas price\">​</a></h2>\n<p>Now, let's set up non-zero gas price on your blockchain. This ensures that:</p>\n<ul>\n<li>Your users will pay the gas fees for the on-chain actions.</li>\n<li>You will collect these gas fees to extract the value from your chain.</li>\n</ul>\n<p>You can check in your terminal that the current gas price is zero by using <a href=\"https://www.quicknode.com/docs/ethereum/eth_gasPrice\" target=\"_blank\" rel=\"noopener noreferrer\"><code>eth_gasPrice</code></a> RPC method:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">curl https://0x4e454265.rpc.aurora-cloud.dev \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  -X POST \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  -H \"Content-Type: application/json\" \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  --data '{\"method\":\"eth_gasPrice\",\"params\":[],\"id\":1,\"jsonrpc\":\"2.0\"}'</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>You will get:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"0x0\"}%</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>You may ask - how to set it in the right way? How should I calculate the value?\nThe long answer is described in <a href=\"https://doc.aurora.dev/blog/evm-gas-near-gas-on-aurora\">this article</a> describing the interplay between the NEAR gas and EVM gas in detail.</p>\n<p>The short one – just use <code>0.07 GWei</code> price (in ETH) - which is the default price on Aurora Mainnet at the moment of the publication of this article.</p>\n<p>Convert it proportionally to your token price and you will get the right number. But what if you don't have the price for your token yet? Don't worry just set it small enough then and correct it later!</p>\n<p>I will use the value <code>0.000001</code> and will enter it into to the <code>Gas price</code> field at the bottom of the page:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"gas price field in aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_gas_price-c6ccbb10660ad317fe0d5fe09e09577f.png\" width=\"3840\" height=\"1874\" class=\"img__pfF\"></p>\n<p>Now, if I will call <code>eth_gasPrice</code> method in my terminal - I get:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"0xe8d4a51000\"}%</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>If you <a href=\"https://www.rapidtables.com/convert/number/hex-to-decimal.html\" target=\"_blank\" rel=\"noopener noreferrer\">decode that hex number</a> into the decimal format, you will see that this is exactly the gas price you have set in the UI.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"fund-your-evm-account\">Fund your EVM account<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#fund-your-evm-account\" class=\"hash-link\" aria-label=\"Direct link to Fund your EVM account\" title=\"Direct link to Fund your EVM account\">​</a></h2>\n<p>Now, if you will want to execute anything - like a coin transfer or smart contract deployment you will need to have a base token on your account. Right now your balance should be 0, as we saw when it <a href=\"https://doc.aurora.dev/blog/create-virtual-chain#adding-a-chain-to-your-wallet\">was added</a> to your wallet.</p>\n<p>After following steps described in the <a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial\">previous article</a>, you got your base token from other blockchain to NEAR.</p>\n<p>Now, it is time to bridge it to your address inside your virtual chain.\nTo do this, we will use <a href=\"https://docs.near.org/tools/near-cli\" target=\"_blank\" rel=\"noopener noreferrer\">NEAR CLI</a>. Go to the <a href=\"https://docs.near.org/tools/near-cli\" target=\"_blank\" rel=\"noopener noreferrer\">official docs</a> and follow installation instructions there.</p>\n<p>For Mac/Linux you can use:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">curl --proto '=https' --tlsv1.2 -LsSf https://github.com/near/near-cli-rs/releases/latest/download/near-cli-rs-installer.sh | sh</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>After that import your NEAR Wallet account (if you're using MyNearWallet) with this command executed in your terminal:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near account import-account using-web-wallet network-config mainnet</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Then, the browser window will open where you will need to import your account:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"near wallet import screen in browser\" src=\"https://doc.aurora.dev/assets/images/acc_near_import-6ecc00c2edf38af97beb77db28041224.png\" width=\"3762\" height=\"1600\" class=\"img__pfF\"></p>\n<p>And when finished, go back to the console and enter your account name there, then press \"Enter\":</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"near wallet account import confirmation in terminal\" src=\"https://doc.aurora.dev/assets/images/acc_near_import_terminal-2460338f88f5e60cd7907dc866790381.png\" width=\"3100\" height=\"1526\" class=\"img__pfF\"></p>\n<p>Account will be added to your NEAR CLI config inside your terminal after that.</p>\n<p>Now, to bridge the funds all you will need to do is executing the next command:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near contract call-function as-transaction &lt;TOKEN_ADDRESS_ON_NEAR&gt; ft_transfer_call json-args '{\"receiver_id\": &lt;ENGINE_CONTRACT&gt;,  \"amount\": &lt;AMOUNT&gt;, \"msg\": &lt;EVM_ADDRESS_LOWERCASED&gt;}' prepaid-gas '300.0 Tgas' attached-deposit '1 yoctoNEAR' sign-as &lt;NEAR_WALLET&gt; network-config mainnet</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>You will need to fill the right values for the <code>&lt;...&gt;</code> placeholders in the command above. In my particular case they are:</p>\n<ul>\n<li><code>&lt;TOKEN_ADDRESS_ON_NEAR&gt; = base-0xf3dfcffc520811d76236892e88d112d2a4a69d0d.omdep.near</code></li>\n<li><code>&lt;ENGINE_CONTRACT&gt; = \"0x4e454265.c.aurora\"</code></li>\n<li><code>&lt;AMOUNT&gt; = \"10000000000000000000\"</code></li>\n<li><code>&lt;EVM_ADDRESS_LOWERCASED&gt; = \"dde068fd58fd10ed15d0f68fc7cd214237a1e9af\"</code></li>\n<li><code>&lt;NEAR_WALLET&gt; = karkunow.near</code></li>\n</ul>\n<div class=\"theme-admonition theme-admonition-note admonition_lH1X alert alert--secondary\"><div class=\"admonitionHeading_SPjx\"><span class=\"admonitionIcon_ghVV\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></span>note</div><div class=\"admonitionContent_RARr\"><p>You need to lowercase the EVM address, which should be your EVM wallet or smart contract address you want to fund on your virtual chain.</p></div></div>\n<p>So, the final command will look like:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near contract call-function as-transaction base-0xf3dfcffc520811d76236892e88d112d2a4a69d0d.omdep.near ft_transfer_call json-args '{\"receiver_id\": \"0x4e454265.c.aurora\",  \"amount\": \"10000000000000000000\", \"msg\": \"dde068fd58fd10ed15d0f68fc7cd214237a1e9af\"}' prepaid-gas '300.0 Tgas' attached-deposit '1 yoctoNEAR' sign-as karkunow.near network-config mainnet</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>After executing, you will receive your NEAR transaction hash and can take a look at it in the <a href=\"https://nearblocks.io/\" target=\"_blank\" rel=\"noopener noreferrer\">NEARBlocks</a>.</p>\n<p>If you now go to your MetaMask, you will see the balance updated:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"updated balance in MetaMask after bridging funds\" src=\"https://doc.aurora.dev/assets/images/acc_near_vgas-b7e719c6a60e395d4af575208a35e9d1.png\" width=\"2306\" height=\"1366\" class=\"img__pfF\"></p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"executing-transaction-inside-evm\">Executing transaction inside EVM<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#executing-transaction-inside-evm\" class=\"hash-link\" aria-label=\"Direct link to Executing transaction inside EVM\" title=\"Direct link to Executing transaction inside EVM\">​</a></h2>\n<p>Now, we ready to execute your first transaction in your virtual chain. Let's transfer some gas tokens to your another account to test it out.</p>\n<p>First of all, create another account in MetaMask, click on your Account Name:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"MetaMask main view showing account name\" src=\"https://doc.aurora.dev/assets/images/mm_main-d52e46836130123720cf361f1f4faad9.png\" width=\"2304\" height=\"912\" class=\"img__pfF\"></p>\n<p>You will see Accounts Dropdown. Now, click on the \"Add account or wallet\" button and create a new account:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"add account or wallet button in MetaMask\" src=\"https://doc.aurora.dev/assets/images/mm_add_wallet-7aafba40a16cad0ac8303f6e46da67fa.png\" width=\"2480\" height=\"1242\" class=\"img__pfF\"></p>\n<p>Choose \"Ethereum account\" type to add:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"ethereum account type selection in MetaMask\" src=\"https://doc.aurora.dev/assets/images/mm_account_type-ef74aa858363ce938796324d40d366e2.png\" width=\"2458\" height=\"1284\" class=\"img__pfF\"></p>\n<p>After that enter the name of the account and click \"Add\" button. Account will be created.\nSwitch back to your old account.</p>\n<p>Now let's send some tokens to your freshly created account, click \"Send\":</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"send button in MetaMask\" src=\"https://doc.aurora.dev/assets/images/mm_send-0777ab0704ea1a737423daff873af013.png\" width=\"2304\" height=\"912\" class=\"img__pfF\"></p>\n<p>Choose your new account in the \"To\" field, enter some amount of tokens to transfer, and click \"Continue\":</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"token transfer form in MetaMask\" src=\"https://doc.aurora.dev/assets/images/mm_send_2-164c20e5624dc1e18b98da82f18725c0.png\" width=\"2448\" height=\"1242\" class=\"img__pfF\"></p>\n<p>Then, review the data and click \"Confirm\":</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"transaction confirmation screen in MetaMask\" src=\"https://doc.aurora.dev/assets/images/mm_send_3-8e55a38c46e65c6faca21a550a1a75cf.png\" width=\"2506\" height=\"1350\" class=\"img__pfF\"></p>\n<p>You will the balance on your new account updated:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"updated balance on new MetaMask account after transfer\" src=\"https://doc.aurora.dev/assets/images/mm_send_4-d114283be9bf7adda7d161fdf674e8da.png\" width=\"2198\" height=\"1214\" class=\"img__pfF\"></p>\n<p>To find the transaction in the Explorer, go to the MetaMask main view, locate your transfer there, and click on it:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"transaction details in MetaMask\" src=\"https://doc.aurora.dev/assets/images/mm_explorer_1-bd3c56b7557d909720069d8d2f7323d9.png\" width=\"2280\" height=\"1190\" class=\"img__pfF\"></p>\n<p>After that click on \"View on block explorer\" button:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"view on block explorer button in MetaMask\" src=\"https://doc.aurora.dev/assets/images/mm_explorer_2-1e8b8fc27b9d36d548bddf4cd08d3bcd.png\" width=\"2194\" height=\"1208\" class=\"img__pfF\"></p>\n<p>The new window will open where you can see more details, gas consumed and copy <a href=\"https://0x4e454265.explorer.aurora-cloud.dev/tx/0x1d8b006066402bf05b05b3bb3d6dc75df9b2fa0dfc26a2f7ce507c6b07425560\" target=\"_blank\" rel=\"noopener noreferrer\">transaction URL</a> or hash if needed:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"transaction details on aurora cloud block explorer\" src=\"https://doc.aurora.dev/assets/images/mm_explorer_3-5d3be29963115379d964112dfd113469.png\" width=\"3840\" height=\"1710\" class=\"img__pfF\"></p>\n<p>If you want, execute a few more transactions now, or <a href=\"https://doc.aurora.dev/build-a-dapp/introduction\">deploy some smart contracts</a> to your virtual chain to collect more gas on your relayer account.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"collect-the-gas-to-your-near-account\">Collect the gas to your NEAR account<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#collect-the-gas-to-your-near-account\" class=\"hash-link\" aria-label=\"Direct link to Collect the gas to your NEAR account\" title=\"Direct link to Collect the gas to your NEAR account\">​</a></h2>\n<p>After users has had some activity on your virtual chain, you can collect the gas in the <a href=\"https://app.auroracloud.dev/\" target=\"_blank\" rel=\"noopener noreferrer\">Aurora Cloud</a> Console. To do this, go to \"Gas abstraction\", and then to the \"Gas collected\" tab:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"gas collected tab in aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_gas_collection-0e280ac203fc2773e5b3ab6c3165ffd6.png\" width=\"3836\" height=\"1908\" class=\"img__pfF\"></p>\n<p>You will see the amount of gas accumulated there. Please, enter your NEAR account there if you haven't done this previously. It should be your NEAR wallet address.</p>\n<p>After that, click \"Collect\" button, you will see a popup:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"gas collection popup in aurora cloud\" src=\"https://doc.aurora.dev/assets/images/acc_gas_collection_2-e86a7f7383d4d0ece1c6d03f5e20aec0.png\" width=\"3824\" height=\"1924\" class=\"img__pfF\"></p>\n<p>Click \"Collect gas\" and your gas will be transferred to the specified NEAR account. You can find that transaction on NEARBlocks Explorer:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"gas collection transaction on nearblocks\" src=\"https://doc.aurora.dev/assets/images/acc_gas_collection_3-18ceea5adfac0213375496560eaf7330.png\" width=\"3840\" height=\"2044\" class=\"img__pfF\"></p>\n<p>Here are the details from the particular transaction I had:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"gas collection transaction details\" src=\"https://doc.aurora.dev/assets/images/acc_gas_collection_4-0508c13aab8efda28f7eaa86494cdd45.png\" width=\"3836\" height=\"1786\" class=\"img__pfF\"></p>\n<p>As you can see <code>0.063 VGAS</code> were transferred to my account.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"conclusions\">Conclusions<a href=\"https://doc.aurora.dev/blog/create-virtual-chain#conclusions\" class=\"hash-link\" aria-label=\"Direct link to Conclusions\" title=\"Direct link to Conclusions\">​</a></h2>\n<p>In this article we have successfully:</p>\n<ul>\n<li>Set up a new chain with a custom base token</li>\n<li>Learned about how NEAR gas is related to the EVM gas</li>\n<li>Funded our EVM account with the base token</li>\n<li>Executed some simple transactions</li>\n<li>Collected some gas tokens to our NEAR wallet</li>\n</ul>\n<p>That is it for today! Hope you have enjoyed it!</p>\n<p>If you have encountered any errors, problems or just have any questions or suggestions, please contact us on <a href=\"https://discord.gg/auroralabs\" target=\"_blank\" rel=\"noopener noreferrer\">Discord</a>.</p>",
            "url": "https://doc.aurora.dev/blog/create-virtual-chain",
            "title": "Create your first EVM in minutes",
            "summary": "In this article we demonstrate how you can use Omnibridge and AuroraCloud Console to deploy your own EVM in minutes",
            "date_modified": "2025-08-14T00:00:00.000Z",
            "author": {
                "name": "Slava Karkunov"
            },
            "tags": [
                "Tutorials",
                "Aurora Cloud"
            ]
        },
        {
            "id": "https://doc.aurora.dev/blog/omnibridge-tutorial",
            "content_html": "<p>In this short tutorial we will show how by using <a href=\"https://docs.near.org/chain-abstraction/omnibridge/overview\" target=\"_blank\" rel=\"noopener noreferrer\">Omni Bridge</a> you can bring your custom token from other chains (e.g., Solana, Base, Ethereum) to NEAR ecosystem.</p>\n<p>To do this we have created a custom token called <a href=\"https://base.blockscout.com/token/0xF3dFcfFc520811D76236892e88d112D2A4a69D0d\" target=\"_blank\" rel=\"noopener noreferrer\">VGAS</a> on Base already in <a href=\"https://doc.aurora.dev/blog/thirdweb-erc20\">previous tutorial</a>.</p>\n<p>Now, we want to bridge it to NEAR and use corresponding fungible token (NEP-141 on NEAR) as a gas token for a virtual chain in the next article.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"quick-plan\">Quick plan<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#quick-plan\" class=\"hash-link\" aria-label=\"Direct link to Quick plan\" title=\"Direct link to Quick plan\">​</a></h2>\n<p>We're going to:</p>\n<ol>\n<li>Install Rust</li>\n<li>Install <code>bridge-cli</code></li>\n<li>Configure <code>.env</code> variables for <code>bridge-cli</code></li>\n<li>Deploy <a href=\"https://base.blockscout.com/token/0xF3dFcfFc520811D76236892e88d112D2A4a69D0d\" target=\"_blank\" rel=\"noopener noreferrer\">VGAS</a> via Omni Bridge to NEAR to get NEP-141 token there.</li>\n<li>Bridge some of your tokens from Base to NEAR.</li>\n</ol>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"requirements\">Requirements<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#requirements\" class=\"hash-link\" aria-label=\"Direct link to Requirements\" title=\"Direct link to Requirements\">​</a></h2>\n<p>Please, create or prepare any ERC-20 token from Base, Arbitrum or Ethereum to be used.\nYou can also try this out with SPL tokens on Solana. We will use the <a href=\"https://base.blockscout.com/token/0xF3dFcfFc520811D76236892e88d112D2A4a69D0d\" target=\"_blank\" rel=\"noopener noreferrer\">VGAS</a> token from the <a href=\"https://doc.aurora.dev/blog/thirdweb-erc20\">thirdweb ERC-20 tutorial</a>.</p>\n<p>We're expecting you to have your <a href=\"https://metamask.io/faqs\" target=\"_blank\" rel=\"noopener noreferrer\">MetaMask installed</a> and your wallet already created there. You can use any other EVM wallet too. E.g., Rabby, Brave or Coinbase Wallet.</p>\n<p>You also will need your NEAR wallet prepared. We recommend using <a href=\"https://www.mynearwallet.com/\" target=\"_blank\" rel=\"noopener noreferrer\">MyNearWallet</a>, but any other will suffice. You will just need to take your private key out of it and use it in <code>bridge-cli</code>.</p>\n<p>Also, please get some real funds there to pay for gas and token deployments. You will need 3+ NEAR to be on your NEAR wallet and some ETH present on your Base wallet.\nWe recommend using <a href=\"https://near-intents.org/\" target=\"_blank\" rel=\"noopener noreferrer\">NEAR Intents</a> to swap and bridge tokens between different chains.</p>\n<p>Please contact us on <a href=\"https://discord.gg/auroralabs\" target=\"_blank\" rel=\"noopener noreferrer\">Discord</a> if you will need any help with getting funds for gas fees.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"installing-rust\">Installing Rust<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#installing-rust\" class=\"hash-link\" aria-label=\"Direct link to Installing Rust\" title=\"Direct link to Installing Rust\">​</a></h2>\n<p>We will use a Rust library called <a href=\"https://github.com/Near-One/bridge-sdk-rs\" target=\"_blank\" rel=\"noopener noreferrer\">bridge-sdk-rs</a> of which <a href=\"https://github.com/Near-One/bridge-sdk-rs/tree/main/bridge-cli\" target=\"_blank\" rel=\"noopener noreferrer\">bridge-cli</a> is a part of.\nSo, let's install Rust first by using the next command on Mac or Linux:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">curl https://sh.rustup.rs -sSf | sh</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>If you're using Windows, please follow instructions on <a href=\"https://doc.rust-lang.org/cargo/getting-started/installation.html\" target=\"_blank\" rel=\"noopener noreferrer\">rust-lang.org</a>.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"installing-bridge-cli\">Installing bridge-cli<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#installing-bridge-cli\" class=\"hash-link\" aria-label=\"Direct link to Installing bridge-cli\" title=\"Direct link to Installing bridge-cli\">​</a></h2>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"download-binary\">Download binary<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#download-binary\" class=\"hash-link\" aria-label=\"Direct link to Download binary\" title=\"Direct link to Download binary\">​</a></h3>\n<p>Visit <a href=\"https://github.com/Near-One/bridge-sdk-rs/releases/latest\" target=\"_blank\" rel=\"noopener noreferrer\">releases page</a> to download a binary for your platform</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"manual-compilation\">Manual compilation<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#manual-compilation\" class=\"hash-link\" aria-label=\"Direct link to Manual compilation\" title=\"Direct link to Manual compilation\">​</a></h3>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># Clone the repository</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">git clone https://github.com/near-one/bridge-sdk-rs.git</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">cd bridge-sdk-rs</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># Build the CLI</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">cargo build --release</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># The binary will be available at</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">./target/release/bridge-cli</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"put-that-binary-on-your-path\">Put that binary on your $PATH<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#put-that-binary-on-your-path\" class=\"hash-link\" aria-label=\"Direct link to Put that binary on your $PATH\" title=\"Direct link to Put that binary on your $PATH\">​</a></h3>\n<div class=\"theme-admonition theme-admonition-note admonition_lH1X alert alert--secondary\"><div class=\"admonitionHeading_SPjx\"><span class=\"admonitionIcon_ghVV\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></span>note</div><div class=\"admonitionContent_RARr\"><p>The PATH variable is an environment variable that specifies a list of directories that the operating system searches when you enter a command. It allows you to run commands and programs without specifying their full path, making it easier to use the command line.</p></div></div>\n<p>You can read more about what is <a href=\"https://en.wikipedia.org/wiki/PATH_(variable)\" target=\"_blank\" rel=\"noopener noreferrer\">$PATH variable</a> on Wiki.\nAnd <a href=\"https://jvns.ca/blog/2025/02/13/how-to-add-a-directory-to-your-path/\" target=\"_blank\" rel=\"noopener noreferrer\">a detailed tutorial</a> on how to change it.</p>\n<p>Overall, you can just open your favorite terminal, I will use <a href=\"https://iterm2.com/\" target=\"_blank\" rel=\"noopener noreferrer\">iTerm2</a> and enter:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">echo $PATH</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>You will see something like:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">/Users/aurora/Library/pnpm:/Applications/Sublime Text.app/Contents/SharedSupport/bin:/Users/aurora/bin:/Users/aurora/.cargo/bin:/Users/aurora/.foundry/bin</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>It is just a bunch of folders concateneted by ':' symbol. So you can take one of these, e.g., <code>/Users/aurora/.foundry/bin</code> in my case, and put <code>bridge-cli</code> binary there.</p>\n<p>After that you will able to execute the next command in your terminal:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">bridge-cli --help</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>and get</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">Usage: bridge-cli &lt;NETWORK&gt; &lt;COMMAND&gt;</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">Commands:</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  log-metadata                      Log metadata for a token</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  deploy-token                      Deploy a token</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  is-transfer-finalised             Check if transfer is finalised</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  near-storage-deposit              Deposit storage for a token on NEAR</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  near-sign-transfer                Sign a transfer on NEAR</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  near-init-transfer                Initialize a transfer on NEAR</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  near-fin-transfer-with-evm-proof  Finalize a transfer on NEAR using EVM proof</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  near-fin-transfer-with-vaa        Finalize a transfer on NEAR using VAA</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  near-fast-fin-transfer            Finalize a transfer on NEAR using fast transfer</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">...</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>If <code>bridge-cli</code> is not on your PATH, you will see something like that:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">zsh: command not found: bridge-cli</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"configuring-env-file\">Configuring .env file<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#configuring-env-file\" class=\"hash-link\" aria-label=\"Direct link to Configuring .env file\" title=\"Direct link to Configuring .env file\">​</a></h3>\n<div class=\"theme-admonition theme-admonition-warning admonition_lH1X alert alert--warning\"><div class=\"admonitionHeading_SPjx\"><span class=\"admonitionIcon_ghVV\"><svg viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z\"></path></svg></span>Security warning: protect your private keys</div><div class=\"admonitionContent_RARr\"><p>Storing raw private keys in a plaintext <code>.env</code> file is dangerous. Never commit this file to version control and prefer secret managers (e.g., 1Password CLI, <code>pass</code>, Bitwarden CLI, or environment-injection in CI like GitHub Actions secrets).</p><p>At minimum, add <code>.env</code> to your <code>.gitignore</code>:</p><div class=\"language-gitignore codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-gitignore codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">.env</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Rotate any keys that might have been exposed.\nOnly store the keys you're willing to lose as a plaintext in the <code>.env</code> file.</p></div></div>\n<p>Let's configure environment variables now. To do this, create the <code>.env</code> file in your current folder:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">touch .env</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Open it in your favorite text editor, I will use Sublime Text, and enter the next info:</p>\n<div class=\"language-.env codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-.env codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># e.g. karkunow.near</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">NEAR_SIGNER=&lt;signer-account-id&gt; </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">NEAR_PRIVATE_KEY=&lt;signer-private-key&gt;</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">BASE_PRIVATE_KEY=&lt;base-private-key&gt;</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># mainnet</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">TOKEN_LOCKER_ID=omni.bridge.near</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Optionally, you can provide also:</p>\n<div class=\"language-.env codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-.env codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># testnet</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># TOKEN_LOCKER_ID=omni-locker.testnet</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># ARB_PRIVATE_KEY=&lt;arbitrum-private-key&gt;</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># ETH_PRIVATE_KEY=&lt;eth-private-key&gt;</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># you can provide solana's keypair as base58 string</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># SOLANA_KEYPAIR=&lt;solana-keypair-bs58&gt;</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># or by providing an absolute path to the file where keypair is stored</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># SOLANA_KEYPAIR=/Users/.../solana-wallet.json</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>But we won't need Solana, Eth or Arbitrum keys in this tutorial.</p>\n<p>As you can see, we will need to get our EVM wallet and NEAR wallet private keys and put them to the <code>.env</code> file.Here is <a href=\"https://support.metamask.io/configure/accounts/how-to-export-an-accounts-private-key/\" target=\"_blank\" rel=\"noopener noreferrer\">a tutorial</a> on how to do it in MetaMask.</p>\n<p>For the <a href=\"https://app.mynearwallet.com/\" target=\"_blank\" rel=\"noopener noreferrer\">MyNearWallet</a>:</p>\n<ul>\n<li>go to your <a href=\"https://app.mynearwallet.com/profile\" target=\"_blank\" rel=\"noopener noreferrer\">account page</a></li>\n<li>scroll down to the bottom and click \"Export Local Private Key\" button</li>\n<li>enter your account id in the popup</li>\n<li>click \"View Private Key\"</li>\n<li>copy it your <code>.env</code> file</li>\n</ul>\n<p>\"Export Local Private Key\" button is located here:\n<img decoding=\"async\" loading=\"lazy\" alt=\"export local private key button in MyNearWallet\" src=\"https://doc.aurora.dev/assets/images/om_mnw_key-367ae476cccbb5f05bf2a4ba0ea0cda8.png\" width=\"3796\" height=\"1198\" class=\"img__pfF\"></p>\n<p>Now that your <code>.env</code> file is ready, go to your terminal and execute:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">source .env</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"deploying-token-to-near\">Deploying token to NEAR<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#deploying-token-to-near\" class=\"hash-link\" aria-label=\"Direct link to Deploying token to NEAR\" title=\"Direct link to Deploying token to NEAR\">​</a></h2>\n<p>Now, let's take our <a href=\"https://base.blockscout.com/token/0xF3dFcfFc520811D76236892e88d112D2A4a69D0d\" target=\"_blank\" rel=\"noopener noreferrer\">VGAS</a> token and try to deploy it to NEAR. But before doing that note the next information.</p>\n<div class=\"theme-admonition theme-admonition-note admonition_lH1X alert alert--secondary\"><div class=\"admonitionHeading_SPjx\"><span class=\"admonitionIcon_ghVV\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></span>note</div><div class=\"admonitionContent_RARr\"><ul>\n<li>You have to wait for around 20 minutes for transaction confirmation after calling any method on EVM chain. Otherwise, you'll get ERR_INVALID_BLOCK_HASH meaning that light client or wormhole is not yet synced with the block that transaction was included in</li>\n<li>Replace placeholder values (addresses, amounts, hashes) with actual values</li>\n<li>Token amounts are specified in their smallest units (e.g., wei for ETH, yoctoNEAR for NEAR)</li>\n<li>Always test with small amounts on testnet first</li>\n<li>Ensure you have sufficient funds for gas fees and storage deposits</li>\n</ul></div></div>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"log-metadata\">Log metadata<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#log-metadata\" class=\"hash-link\" aria-label=\"Direct link to Log metadata\" title=\"Direct link to Log metadata\">​</a></h3>\n<p>First, we will need to log the token's metadata. To do that we will use <code>log-metadata</code> command and VGAS token address <code>0xF3dFcfFc520811D76236892e88d112D2A4a69D0d</code> with <code>base:</code> prefix in front of it:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># Log VGAS token metadata on Base</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">bridge-cli mainnet log-metadata --token base:0xF3dFcfFc520811D76236892e88d112D2A4a69D0d</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>After that, we will get:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">2025-08-05T22:24:45.499822Z LOG METADATA: Sent new bridge token transaction</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">tx_hash=\"0xa7c4284c84a847ec8938b15dd14c4ca83da8d49439615561c229b7411b809e4c\"</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>If we examine <a href=\"https://basescan.org/tx/0xa7c4284c84a847ec8938b15dd14c4ca83da8d49439615561c229b7411b809e4c\" target=\"_blank\" rel=\"noopener noreferrer\">the transaction</a> via Basescan we will see that it took only $0.001 from our account.</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"deploying-token-to-near-1\">Deploying token to NEAR<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#deploying-token-to-near-1\" class=\"hash-link\" aria-label=\"Direct link to Deploying token to NEAR\" title=\"Direct link to Deploying token to NEAR\">​</a></h3>\n<p>To deploy your token to NEAR you will need to wait now around 20 minutes for transfer to be catched up by the Omnibridge services. So you can relax, and get you some tea at this moment. Meditate or just gaze around, relax a bit :)</p>\n<div class=\"theme-admonition theme-admonition-note admonition_lH1X alert alert--secondary\"><div class=\"admonitionHeading_SPjx\"><span class=\"admonitionIcon_ghVV\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></span>note</div><div class=\"admonitionContent_RARr\"><p>EVM part, except Ethereum, is covered right now by the Wormhole bridge (in future, it will secured by Chain Signatures on NEAR). So, you can also monitor your transactions via <a href=\"https://wormholescan.io/#/txs?address=0xBe3e4Cb196bC9579c1C161cA5a2A4D47eD439469&amp;network=Mainnet\" target=\"_blank\" rel=\"noopener noreferrer\">WormholeScan</a>. When available there, you can try executing <code>deploy-token</code> method.</p></div></div>\n<p>After that, be ready to execute:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">bridge-cli mainnet deploy-token \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    --source-chain Base \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    --chain Near \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    --tx-hash 0xa7c4284c84a847ec8938b15dd14c4ca83da8d49439615561c229b7411b809e4c</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>As you can see, I have used the <code>log-metadata</code> transaction hash in the command above. You will see an output similar to the next one:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">2025-08-05T22:48:51.107287Z DEPLOY TOKEN: Sent deploy token transaction</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">tx_hash=\"EPJWeaHRZWZBf49YgYDj55oHefSZPgQmRye2WsnnbxRv\"</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Now, if you take a look at the details of that transaction on <a href=\"https://nearblocks.io/txns/EPJWeaHRZWZBf49YgYDj55oHefSZPgQmRye2WsnnbxRv\" target=\"_blank\" rel=\"noopener noreferrer\">Nearblocks</a>, you will see that:</p>\n<ol>\n<li>It spent 3.00771 NEAR from <code>karkunow.near</code> account</li>\n<li>It called <code>deploy_token</code> method on <code>omni.bridge.near</code> contract.</li>\n<li>In the <code>Interacted With</code> field, you can notice a new account created there and 3 NEAR got deposited into it.</li>\n</ol>\n<p>Here is how it looks like in the <code>Interacted With</code> field:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"NEP-141 token account on NearBlocks\" src=\"https://doc.aurora.dev/assets/images/om_near_token-eed438762dd279b56f5601e1cf2faaf5.png\" width=\"2762\" height=\"948\" class=\"img__pfF\"></p>\n<p>This is exactly <a href=\"https://nearblocks.io/address/base-0xf3dfcffc520811d76236892e88d112d2a4a69d0d.omdep.near\" target=\"_blank\" rel=\"noopener noreferrer\">the NEP-141 token account</a> which is a bridged version of the <a href=\"https://base.blockscout.com/token/0xF3dFcfFc520811D76236892e88d112D2A4a69D0d\" target=\"_blank\" rel=\"noopener noreferrer\">VGAS</a> token, but now on NEAR!</p>\n<p>As you can see, <a href=\"https://nearblocks.io/address/base-0xf3dfcffc520811d76236892e88d112d2a4a69d0d.omdep.near\" target=\"_blank\" rel=\"noopener noreferrer\">its name</a> mirrors the Base ERC-20 name, but has a prefix <code>base-</code> and suffix <code>.omdep.near</code> added, with lowercased ERC-20 address in-between these.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"bridging-your-tokens\">Bridging your tokens<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#bridging-your-tokens\" class=\"hash-link\" aria-label=\"Direct link to Bridging your tokens\" title=\"Direct link to Bridging your tokens\">​</a></h2>\n<p>Now, I want to move 100 VGAS from Base to NEAR.</p>\n<p>To initialize the transfer we'll need to estimate fees first by providing recipient, sender and token to the API:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">curl 'https://mainnet.api.bridge.nearone.org/api/v1/transfer-fee?recipient=near:karkunow.near&amp;sender=base:0xBe3e4Cb196bC9579c1C161cA5a2A4D47eD439469&amp;token=base:0xF3dFcfFc520811D76236892e88d112D2A4a69D0d'</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>We have used the next arguments above:</p>\n<ul>\n<li>Recipient: near<!-- -->:karkunow<!-- -->.near</li>\n<li>Sender: base:0xBe3e4Cb196bC9579c1C161cA5a2A4D47eD439469</li>\n<li>Token: base:0xF3dFcfFc520811D76236892e88d112D2A4a69D0d</li>\n</ul>\n<p>The command will output us:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">{\"native_token_fee\":\"3273397399996\",\"transferred_token_fee\":null,\"usd_fee\":0.01}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p><code>usd_fee</code> just shows how much it will cost to us to execute the bridge transaction on Base in USD. But we won't need that field for now.</p>\n<p>We should use <code>native_token_fee</code> as <code>native_fee</code> and <code>transferred_token_fee</code> as <code>fee</code> in the initialization command. Let's initialize transfer on Base by using these values:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">bridge-cli mainnet evm-init-transfer \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    --chain base \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    --token 0xF3dFcfFc520811D76236892e88d112D2A4a69D0d \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    --amount 100000000000000000000 \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    --recipient near:karkunow.near \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    --fee 0 \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    --native-fee 3273397399996 \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    --message \"\"</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<div class=\"theme-admonition theme-admonition-tip admonition_lH1X alert alert--success\"><div class=\"admonitionHeading_SPjx\"><span class=\"admonitionIcon_ghVV\"><svg viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></span>tip</div><div class=\"admonitionContent_RARr\"><p>Leave <code>--message</code> to be an empty string if you're making transfer to the regular NEAR account, it should be used only to call methods on the NEAR smart contracts.</p></div></div>\n<p>I have used <a href=\"https://www.eth-to-wei.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Wei converter</a> to get 18 decimals for my 100 VGAS transfer to get the correct number with 18 decimals.</p>\n<p>I get this as an output after execution of the command above:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">2025-08-06T13:17:52.048469Z EVM INIT TRANSFER: Sent transfer transaction</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">tx_hash=\"0x7df8da588a7894ce666aa374b37ccb9c00bb454d97f92cc30be2578762c5237a\"</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>If you'll <a href=\"https://basescan.org/tx/0x7df8da588a7894ce666aa374b37ccb9c00bb454d97f92cc30be2578762c5237a\" target=\"_blank\" rel=\"noopener noreferrer\">go to the Basescan</a>, you will see that inside that transaction <code>initTransfer</code> method was called on the bridge Base contract:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"initTransfer transaction on Basescan\" src=\"https://doc.aurora.dev/assets/images/om_init_transfer-ef75b739a44b3eaa4a787a9319e93fb2.png\" width=\"2760\" height=\"760\" class=\"img__pfF\"></p>\n<p>Then you will need to wait for around 20-25 minutes for that action to be accepted by Omni Bridge services.</p>\n<p>Just a reminder, for Base and Arbitrum, you can also monitor your transactions via <a href=\"https://wormholescan.io/#/txs?address=0xBe3e4Cb196bC9579c1C161cA5a2A4D47eD439469&amp;network=Mainnet\" target=\"_blank\" rel=\"noopener noreferrer\">WormholeScan</a>.</p>\n<p>If you go to WormholeScan and enter your base EOA there, you will see a list of your bridge-related transactions there:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"Wormhole VAA dashboard\" src=\"https://doc.aurora.dev/assets/images/om_vaa_dash-f16d2f6880bab8580cefeaa70964833e.png\" width=\"3566\" height=\"1702\" class=\"img__pfF\"></p>\n<p>The status will switch to <code>COMPLETED</code> in 20-25 minutes, the transaction info will look like this:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"Omni relayer transactions list on NearBlocks\" src=\"https://doc.aurora.dev/assets/images/om_fin_tx_dash-c3aafd6dc500f1d9089c936e522ad9d4.png\" width=\"3128\" height=\"1890\" class=\"img__pfF\"></p>\n<p>Transaction will be finalized automatically for you by <code>omni-relayer.bridge.near</code> account on the NEAR side.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"finding-finalization-transaction\">Finding finalization transaction<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#finding-finalization-transaction\" class=\"hash-link\" aria-label=\"Direct link to Finding finalization transaction\" title=\"Direct link to Finding finalization transaction\">​</a></h2>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"simple-way\">Simple way<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#simple-way\" class=\"hash-link\" aria-label=\"Direct link to Simple way\" title=\"Direct link to Simple way\">​</a></h3>\n<p>Just go by URL to call OmniBridge API, or <code>curl</code> it:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">curl https://mainnet.api.bridge.nearone.org/api/v1/transfers/?transaction_id=0x7df8da588a7894ce666aa374b37ccb9c00bb454d97f92cc30be2578762c5237a&amp;offset=0&amp;limit=5</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Put your transaction hash as <code>transaction_id</code> there. You will recieve the next data in response:</p>\n<div class=\"language-json codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token punctuation\" style=\"color:#393A34\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#36acaa\">\"id\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#36acaa\">\"origin_chain\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"Base\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#36acaa\">\"origin_nonce\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">11</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#36acaa\">\"initialized\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#36acaa\">\"EVMLog\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#36acaa\">\"block_height\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">33848463</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#36acaa\">\"block_timestamp_seconds\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1754486273</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#36acaa\">\"transaction_hash\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"0x7df8da588a7894ce666aa374b37ccb9c00bb454d97f92cc30be2578762c5237a\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#36acaa\">\"signed\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#00009f\">null</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#36acaa\">\"updated_fee\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">[</span><span class=\"token punctuation\" style=\"color:#393A34\">]</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#36acaa\">\"fast_finalised_on_near\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#00009f\">null</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#36acaa\">\"finalised_on_near\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#00009f\">null</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#36acaa\">\"fast_finalised\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#00009f\">null</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#36acaa\">\"finalised\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#36acaa\">\"NearReceipt\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#36acaa\">\"block_height\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">158474326</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#36acaa\">\"block_timestamp_seconds\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1754487576</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#36acaa\">\"transaction_hash\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"C2SsiJYnGdHXkDGm6SP7XxaBF2c9Z8MB8RL4kgXy4XtM\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#36acaa\">\"claimed\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token null keyword\" style=\"color:#00009f\">null</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token property\" style=\"color:#36acaa\">\"transfer_message\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#36acaa\">\"token\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"base:0xf3dfcffc520811d76236892e88d112d2a4a69d0d\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#36acaa\">\"amount\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"100000000000000000000\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#36acaa\">\"sender\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"base:0xbe3e4cb196bc9579c1c161ca5a2a4d47ed439469\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#36acaa\">\"recipient\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"near:karkunow.near\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#36acaa\">\"fee\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#36acaa\">\"fee\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"0\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token property\" style=\"color:#36acaa\">\"native_fee\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"3273397399996\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      </span><span class=\"token property\" style=\"color:#36acaa\">\"msg\"</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">]</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Inside <code>\"NearReceipt\"</code> you will find <code>\"transaction_hash\"</code>, which is the hash of your <a href=\"https://nearblocks.io/txns/C2SsiJYnGdHXkDGm6SP7XxaBF2c9Z8MB8RL4kgXy4XtM\" target=\"_blank\" rel=\"noopener noreferrer\">finalization transaction</a> on the target blockchain.</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"complex-way\">Complex way<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#complex-way\" class=\"hash-link\" aria-label=\"Direct link to Complex way\" title=\"Direct link to Complex way\">​</a></h3>\n<p>Now, let's take a look how you could have find it in NearBlocks explorer.</p>\n<p>Note the time of transaction from WormholeScan or BaseScan, it was <code>2025-08-06 13:17:53 UTC</code> in this case.</p>\n<p>Now, if you want to find the finalization transaction, go to the <a href=\"https://nearblocks.io/address/omni-relayer.bridge.near\" target=\"_blank\" rel=\"noopener noreferrer\">Omni Bridge Relayer</a> on NearBlocks, and find the transaction there with a timestamp around that time plus 20 minutes, so it should be <code>2025-08-06 13:37:53 UTC</code>.</p>\n<p>You could hover on the <code>AGE</code> field to see timestamps, like this:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"mint event in finalization transaction\" src=\"https://doc.aurora.dev/assets/images/om_fin_tx_dash-c3aafd6dc500f1d9089c936e522ad9d4.png\" width=\"3128\" height=\"1890\" class=\"img__pfF\"></p>\n<p>As you can see there is only one close enough to my time here. And that is exactly the transaction we have found via API in the last section.</p>\n<p>Let's click on it, and then scroll <code>Interacted With (To)</code> list of event until you see <code>mint</code> functions on <code>base-...</code> contract:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"execution plan details for finalization transaction\" src=\"https://doc.aurora.dev/assets/images/om_fin_tx_mint-8bdd4771c763e5552e806e5d6a6f8822.png\" width=\"3826\" height=\"1880\" class=\"img__pfF\"></p>\n<p>When you click on the small arrow near the <code>mint</code> event you will be redirected to the <code>Execution Plan</code> tab, and see more info about it:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"execution plan details for finalization transaction\" src=\"https://doc.aurora.dev/assets/images/om_fin_tx_info-c07b216718f125ef8d34f0585a5852d3.png\" width=\"3236\" height=\"1008\" class=\"img__pfF\"></p>\n<p>You should see the exact info you have passed to the <code>evm-init-transfer</code> command above!</p>\n<p>That is it, you now have your tokens on your balance, which you can check in your NEAR Wallet, e.g., <a href=\"https://app.mynearwallet.com/\" target=\"_blank\" rel=\"noopener noreferrer\">MyNearWallet</a>.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"conclusions\">Conclusions<a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial#conclusions\" class=\"hash-link\" aria-label=\"Direct link to Conclusions\" title=\"Direct link to Conclusions\">​</a></h2>\n<p>That is it! We have bridged your first tokens via Omni Bridge CLI together!</p>\n<p>You can take a look at the transactions which happened during this tutorial on block explorer:</p>\n<ul>\n<li><a href=\"https://basescan.org/tx/0xa7c4284c84a847ec8938b15dd14c4ca83da8d49439615561c229b7411b809e4c\" target=\"_blank\" rel=\"noopener noreferrer\">Log metadata - $0.001</a></li>\n<li><a href=\"https://nearblocks.io/txns/EPJWeaHRZWZBf49YgYDj55oHefSZPgQmRye2WsnnbxRv\" target=\"_blank\" rel=\"noopener noreferrer\">Deployment transaction on NEAR - $7.49 or 3.01 NEAR, out of which $7.47 went for storage</a></li>\n<li><a href=\"https://basescan.org/tx/0x7df8da588a7894ce666aa374b37ccb9c00bb454d97f92cc30be2578762c5237a\" target=\"_blank\" rel=\"noopener noreferrer\">Bridge transaction - $0.012</a></li>\n</ul>\n<p>Deployment cost: $0.033\nStorage cost: $7.47 (3 NEAR)</p>\n<p>If you are ready - let's start a new virtual chain with that token now in <a href=\"https://doc.aurora.dev/blog/create-virtual-chain\">the next article</a>!</p>\n<p>If you have encountered any errors, problems or just have any questions or suggestions, please contact us on <a href=\"https://discord.gg/auroralabs\" target=\"_blank\" rel=\"noopener noreferrer\">Discord</a>.</p>",
            "url": "https://doc.aurora.dev/blog/omnibridge-tutorial",
            "title": "Bridge-CLI: moving tokens with Omni Bridge",
            "summary": "In this article we demonstrate how you can use Omni Bridge to bridge tokens cross-chain with focus on getting a base token for a virtual chain on NEAR",
            "date_modified": "2025-08-10T00:00:00.000Z",
            "author": {
                "name": "Slava Karkunov"
            },
            "tags": [
                "Tutorials",
                "Core Tech",
                "Aurora Cloud"
            ]
        },
        {
            "id": "https://doc.aurora.dev/blog/thirdweb-erc20",
            "content_html": "<p>If a developer wants to have their own base token for a <a href=\"https://doc.aurora.dev/aurora-cloud/run-your-own-virtual-chain/overview-of-aurora-cloud\">virtual chain</a> launched via <a href=\"https://app.auroracloud.dev/auth/login\" target=\"_blank\" rel=\"noopener noreferrer\">AuroraCloud</a>, they can use, for example, <a href=\"https://docs.openzeppelin.com/contracts/5.x/erc20\" target=\"_blank\" rel=\"noopener noreferrer\">OpenZeppelin</a> or <a href=\"https://doc.aurora.dev/build-a-dapp/contracts/erc-20\">Aurora Contracts</a>.</p>\n<p>But what if you're just a beginner in the web3 world? <a href=\"https://thirdweb.com/\" target=\"_blank\" rel=\"noopener noreferrer\">thirdweb</a> comes to the rescue here and provides an easy UI to do exactly that - deploy, mint, burn your own ERC-20, and even allows conducting airdrops with it.</p>\n<p>Of course, to be used as a base token for your <a href=\"https://doc.aurora.dev/aurora-cloud/run-your-own-virtual-chain/overview-of-aurora-cloud\">virtual chain</a> that token will need to be bridged to NEAR first via <a href=\"https://docs.near.org/chain-abstraction/omnibridge/overview\" target=\"_blank\" rel=\"noopener noreferrer\">OmniBridge</a>, but we will discuss that in the next article.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"quick-plan\">Quick plan<a href=\"https://doc.aurora.dev/blog/thirdweb-erc20#quick-plan\" class=\"hash-link\" aria-label=\"Direct link to Quick plan\" title=\"Direct link to Quick plan\">​</a></h2>\n<p>We're going to:</p>\n<ol>\n<li>Register on thirdweb</li>\n<li>Create a thirdweb project</li>\n<li>Add a new contract (ERC-20) to the project</li>\n<li>Deploy ERC-20 contract and mint tokens</li>\n<li>Add that ERC-20 to your MetaMask wallet</li>\n</ol>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"requirements\">Requirements<a href=\"https://doc.aurora.dev/blog/thirdweb-erc20#requirements\" class=\"hash-link\" aria-label=\"Direct link to Requirements\" title=\"Direct link to Requirements\">​</a></h2>\n<p>We're expecting you to have your <a href=\"https://metamask.io/faqs\" target=\"_blank\" rel=\"noopener noreferrer\">MetaMask installed</a> and your wallet already created there. You can use any other EVM wallet too. E.g., Rabby, Brave or Coinbase Wallet.</p>\n<p>Also, please get some real funds there to pay for gas and token deployments.\nWe recommend using <a href=\"https://near-intents.org/\" target=\"_blank\" rel=\"noopener noreferrer\">NEAR Intents</a> to swap and bridge tokens between different chains.</p>\n<p>Please contact us on <a href=\"https://discord.gg/auroralabs\" target=\"_blank\" rel=\"noopener noreferrer\">Discord</a> if you will need any help with getting funds for gas fees.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"creating-thirdweb-account\">Creating thirdweb account<a href=\"https://doc.aurora.dev/blog/thirdweb-erc20#creating-thirdweb-account\" class=\"hash-link\" aria-label=\"Direct link to Creating thirdweb account\" title=\"Direct link to Creating thirdweb account\">​</a></h2>\n<p>So, let's go to thirdweb and login there with your wallet:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"thirdweb login with wallet\" src=\"https://doc.aurora.dev/assets/images/thirdweb_login-f491e011c4655c8f1a5a57a9f345bbb1.png\" width=\"2737\" height=\"1255\" class=\"img__pfF\"></p>\n<p>Next, create your account:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"thirdweb create account\" src=\"https://doc.aurora.dev/assets/images/thirdweb_account-64f51ae4b4d39135a93dc657340c5080.png\" width=\"2952\" height=\"1346\" class=\"img__pfF\"></p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"creating-thirdweb-project\">Creating thirdweb project<a href=\"https://doc.aurora.dev/blog/thirdweb-erc20#creating-thirdweb-project\" class=\"hash-link\" aria-label=\"Direct link to Creating thirdweb project\" title=\"Direct link to Creating thirdweb project\">​</a></h2>\n<p>After that you will see your dashboard there:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"thirdweb dashboard\" src=\"https://doc.aurora.dev/assets/images/thirdweb_dashboard-4cc6dcfc29f805a5acd29199c97342ed.png\" width=\"2830\" height=\"1498\" class=\"img__pfF\"></p>\n<p>Click \"Create Project\" button. You will see a popup, enter a name and click \"Allow all domains\" checkbox there:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"thirdweb create project popup\" src=\"https://doc.aurora.dev/assets/images/thirdweb_create_project-c7023a140ef685f5f5d503b7ad784f9d.png\" width=\"2486\" height=\"1264\" class=\"img__pfF\"></p>\n<p>Now, click \"Create\". You will see a popup with your secret key:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"thirdweb project secret key\" src=\"https://doc.aurora.dev/assets/images/thirdweb_secretkey-86719c74440d842acb8fe16d313f73dd.png\" width=\"2864\" height=\"1432\" class=\"img__pfF\"></p>\n<p>Save your secret key in a safe place, such as a password manager inside your browser. Then, tick the checkbox \"I confirm that I have securily stored my secret key\" and click \"View Project\". You will see:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"thirdweb project view\" src=\"https://doc.aurora.dev/assets/images/thirdweb_project-7cdd611ae88e9ecca87518e974d109dd.png\" width=\"3476\" height=\"1514\" class=\"img__pfF\"></p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"deploying-a-contract\">Deploying a contract<a href=\"https://doc.aurora.dev/blog/thirdweb-erc20#deploying-a-contract\" class=\"hash-link\" aria-label=\"Direct link to Deploying a contract\" title=\"Direct link to Deploying a contract\">​</a></h2>\n<p>Click \"Contracts\" at the sidebar, you will see:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"thirdweb contracts list\" src=\"https://doc.aurora.dev/assets/images/thirdweb_contracts-e0b05a14e677e72fc29a221a4b824b17.png\" width=\"3838\" height=\"1218\" class=\"img__pfF\"></p>\n<p>Click \"Discover Contracts\" and choose \"Token\" contract, which is just a regular <a href=\"https://docs.openzeppelin.com/contracts/5.x/erc20\" target=\"_blank\" rel=\"noopener noreferrer\">ERC-20</a>:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"thirdweb discover contracts\" src=\"https://doc.aurora.dev/assets/images/thirdweb_discover_contracts-7a6b03402e8efe03d76aba6db37765ec.png\" width=\"3830\" height=\"1888\" class=\"img__pfF\"></p>\n<p>Then, click \"Deploy Now\" button:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"thirdweb token contract page\" src=\"https://doc.aurora.dev/assets/images/thirdweb_token_page-dd8d8a69bb1c12c2482baa2b8092e509.png\" width=\"3228\" height=\"1752\" class=\"img__pfF\"></p>\n<p>Now, enter your token information:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"thirdweb token information form\" src=\"https://doc.aurora.dev/assets/images/thirdweb_contract_info-72c71d23d93693cc46b17f8393f9312c.png\" width=\"3832\" height=\"1880\" class=\"img__pfF\"></p>\n<p>You can also provide the image for you token above. After that scroll to the bottom of the form and make sure you have Base network (or Arbitrum) selected:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"thirdweb token deploy network selection\" src=\"https://doc.aurora.dev/assets/images/thirdweb_token_deploy-4adfac9be07dbe4a90970eceb842fe0a.png\" width=\"1992\" height=\"638\" class=\"img__pfF\"></p>\n<p>Wait a bit and confirm the transaction in MetaMask:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"MetaMask confirmation for deployment\" src=\"https://doc.aurora.dev/assets/images/thirdweb_mm_confirmation-3d71c7c509034049316668d8ed1bcb9b.png\" width=\"3324\" height=\"1964\" class=\"img__pfF\"></p>\n<p>After that, you will see your token deployed succesfully:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"contract deployed success\" src=\"https://doc.aurora.dev/assets/images/thirdweb_contract_deployed-b2aa57812197cdf55c0b1e8449f1192f.png\" width=\"3542\" height=\"1042\" class=\"img__pfF\"></p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"minting-tokens\">Minting tokens<a href=\"https://doc.aurora.dev/blog/thirdweb-erc20#minting-tokens\" class=\"hash-link\" aria-label=\"Direct link to Minting tokens\" title=\"Direct link to Minting tokens\">​</a></h2>\n<p>You will be redirected here, after clicking \"View Contract\" above:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"token dashboard\" src=\"https://doc.aurora.dev/assets/images/thirdweb_token_dashboard-8db542b41ab77bbddbb4ae288eb838ba.png\" width=\"3788\" height=\"1682\" class=\"img__pfF\"></p>\n<p>As you can see, you need to mint tokens now. So click on \"token tab\" link above, you will go here:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"token actions menu\" src=\"https://doc.aurora.dev/assets/images/thirdweb_token_actions-2ef9c45a0861beab0a67b0204c7ec69c.png\" width=\"3526\" height=\"1008\" class=\"img__pfF\"></p>\n<p>Click \"Mint\" button, you will see a side menu. Enter amount of tokens there (I will mint 1000) and click \"Mint Tokens\" button:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"mint tokens form\" src=\"https://doc.aurora.dev/assets/images/thirdweb_token_minting-a8244143a9efdfb06888236ca6595c13.png\" width=\"2148\" height=\"712\" class=\"img__pfF\"></p>\n<p>Sign a transaction in your wallet:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"mint transaction in wallet\" src=\"https://doc.aurora.dev/assets/images/thirdweb_mint_tx-8173232dc7389ea265d423ee36fde6d6.png\" width=\"2276\" height=\"1214\" class=\"img__pfF\"></p>\n<p>After that you will receive minted tokens to your account.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"adding-token-to-your-wallet\">Adding token to your wallet<a href=\"https://doc.aurora.dev/blog/thirdweb-erc20#adding-token-to-your-wallet\" class=\"hash-link\" aria-label=\"Direct link to Adding token to your wallet\" title=\"Direct link to Adding token to your wallet\">​</a></h2>\n<p>To see your tokens inside your wallet, please click the Basescout button on your token dashboard:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"basescout button on token dashboard\" src=\"https://doc.aurora.dev/assets/images/thirdweb_basescout_button-992db655ffb46316c81b77aa89350674.png\" width=\"3794\" height=\"1454\" class=\"img__pfF\"></p>\n<p>You will see this page opening up, click on the MetaMask icon near the token address:\n<img decoding=\"async\" loading=\"lazy\" alt=\"basescout token page\" src=\"https://doc.aurora.dev/assets/images/thirdweb_basescout-e8f5e10058427c0c37d18e17fb0b86f2.png\" width=\"3808\" height=\"1430\" class=\"img__pfF\"></p>\n<p>You will see MetaMask popup asking you to add a new token, click \"Add\" button:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"MetaMask add token popup\" src=\"https://doc.aurora.dev/assets/images/thirdweb_mm_token_add-fe9714cdb5207a8c0015912807609d49.png\" width=\"2088\" height=\"1244\" class=\"img__pfF\"></p>\n<p>After that you will see your token balance in your wallet:</p>\n<p><img decoding=\"async\" loading=\"lazy\" alt=\"token shown in wallet\" src=\"https://doc.aurora.dev/assets/images/thirdweb_mm_token_shown-56236db27d70d16d43b3ae3d938b309d.png\" width=\"2354\" height=\"1312\" class=\"img__pfF\"></p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"conclusion\">Conclusion<a href=\"https://doc.aurora.dev/blog/thirdweb-erc20#conclusion\" class=\"hash-link\" aria-label=\"Direct link to Conclusion\" title=\"Direct link to Conclusion\">​</a></h2>\n<p>We have deployed and minted a simple ERC-20 token to be used as a base token on your <a href=\"https://doc.aurora.dev/aurora-cloud/run-your-own-virtual-chain/overview-of-aurora-cloud\">virtual chain</a>.\nYou can take a look at the transactions which happened during this tutorial on block explorer:</p>\n<ul>\n<li><a href=\"https://base.blockscout.com/tx/0x5b2fb531f8849b34343f728604a8c0a0a2379c7a5042d556255932acaa86bc51\" target=\"_blank\" rel=\"noopener noreferrer\">Deployment transaction - $0.015</a></li>\n<li><a href=\"https://base.blockscout.com/tx/0x3e44f730b818c5e269b6387df1c13595418b1771d11e98838cca7dc48c4fd05a\" target=\"_blank\" rel=\"noopener noreferrer\">Minting transaction - $0.003</a></li>\n</ul>\n<p>Total cost of creating a token was only around $0.02!</p>\n<p>In the <a href=\"https://doc.aurora.dev/blog/omnibridge-tutorial\">second article</a> we will take a look on how you can bridge that token to NEAR via <a href=\"https://docs.near.org/chain-abstraction/omnibridge/overview\" target=\"_blank\" rel=\"noopener noreferrer\">OmniBridge</a>.</p>\n<p>And in the <a href=\"https://doc.aurora.dev/blog/create-virtual-chain\">third one</a>, how to use it as a base token for your <a href=\"https://doc.aurora.dev/aurora-cloud/run-your-own-virtual-chain/overview-of-aurora-cloud\">virtual chain</a>.</p>\n<p>Of course, it is not obligatory to do it yourself – our team can always help you.\nBut, doing it gives you more understanding around how everything works in Aurora Ecosystem!</p>\n<p>On this note, I wish you great time of the day and I hope you have enjoyed the article!\nThank you!</p>\n<p>If you have encountered any errors, problems or just have any questions or suggestions, please contact us on <a href=\"https://discord.gg/auroralabs\" target=\"_blank\" rel=\"noopener noreferrer\">Discord</a>.</p>",
            "url": "https://doc.aurora.dev/blog/thirdweb-erc20",
            "title": "Launching your base token using thirdweb",
            "summary": "This tutorial demonstrates how to use thirdweb to deploy your own ERC-20 to be used as a base token for your virtual chain",
            "date_modified": "2025-08-06T00:00:00.000Z",
            "author": {
                "name": "Slava Karkunov"
            },
            "tags": [
                "Tutorials",
                "Aurora Cloud",
                "Tips & Tricks"
            ]
        },
        {
            "id": "https://doc.aurora.dev/blog/safe-bitcoin-demo",
            "content_html": "<p>In this article, we will discuss how, by using <a href=\"https://doc.aurora.dev/crosschain/chain-signatures\">Chain Signatures</a> on Aurora, a Safe Wallet could control Bitcoin accounts and their assets.</p>\n<p>This is an example of how a virtual chain could be a runtime environment for another blockchain lacking native smart contracts. <a href=\"https://doc.aurora.dev/crosschain/chain-signatures\">The idea</a> could generally be applied to any virtual chain and any accounts or contracts on it.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"acknowledgements\">Acknowledgements<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#acknowledgements\" class=\"hash-link\" aria-label=\"Direct link to Acknowledgements\" title=\"Direct link to Acknowledgements\">​</a></h2>\n<p>I want to say a big \"Thank You\" to the people helping me out while creating this demo:</p>\n<ul>\n<li>Michael Birch, for <a href=\"https://doc.aurora.dev/crosschain/xcc/aurora-to-near/introduction\">XCC</a> and Chain Signatures consultations.</li>\n<li>Oleksandr Anyshchenko, for writing the main part of the <a href=\"https://github.com/aurora-is-near/chain-signatures-signer\" target=\"_blank\" rel=\"noopener noreferrer\">Chain Signatures Signer</a> contract and support with the demo.</li>\n<li>Diego Figueroa, for debugging a smart contract with me.</li>\n</ul>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"tldr\">TL;DR<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#tldr\" class=\"hash-link\" aria-label=\"Direct link to TL;DR\" title=\"Direct link to TL;DR\">​</a></h2>\n<p>If you don't like to read, you can just watch the video below.</p>\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/ZC2dE9x-9sE?si=8S8oLxb6lqJo71gm\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\"></iframe>\n<div class=\"theme-admonition theme-admonition-tip admonition_lH1X alert alert--success\"><div class=\"admonitionHeading_SPjx\"><span class=\"admonitionIcon_ghVV\"><svg viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></span>tip</div><div class=\"admonitionContent_RARr\"><p>Jump to 3:35 if you want to see only the demo of how it works.</p></div></div>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"what-problem-is-being-solved\">What problem is being solved?<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#what-problem-is-being-solved\" class=\"hash-link\" aria-label=\"Direct link to What problem is being solved?\" title=\"Direct link to What problem is being solved?\">​</a></h2>\n<p>Some blockchains lack smart contracts, such as Bitcoin, Ripple, etc.\nOr have non-EVM architectures and no Solidity contracts available.\nBut you are an EVM dev who wants to build there. Also, you want to have a scalability of the NEAR Protocol at the tips of your hands.</p>\n<p>Then <a href=\"https://docs.near.org/concepts/abstraction/chain-signatures\" target=\"_blank\" rel=\"noopener noreferrer\">NEAR Chain Signatures</a> + a virtual chain, like Aurora, can resolve this problem for you!</p>\n<p>I will demonstrate how it could be done by creating a Safe wallet on Aurora and controlling its derived Bitcoin address.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"the-demo-explained\">The demo explained<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#the-demo-explained\" class=\"hash-link\" aria-label=\"Direct link to The demo explained\" title=\"Direct link to The demo explained\">​</a></h2>\n<p>I wanted a Safe Wallet on Aurora to control the Bitcoin assets on the associated derived account.</p>\n<p>To achieve this, we need two main steps:</p>\n<ol>\n<li>Sign a Bitcoin transaction with MPC service</li>\n<li>Relay this transaction to Bitcoin Network</li>\n</ol>\n<p>To do this, two pieces of technology are combined:</p>\n<ol>\n<li><a href=\"https://doc.aurora.dev/crosschain/xcc/aurora-to-near/introduction\">XCC</a>.</li>\n<li><a href=\"https://docs.near.org/concepts/abstraction/chain-signatures\" target=\"_blank\" rel=\"noopener noreferrer\">NEAR Chain Signatures</a> (<a href=\"https://docs.near.org/concepts/abstraction/chain-signatures\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.near.org/concepts/abstraction/chain-signatures</a>) (MPC + utils to derive accounts, form transactions).</li>\n</ol>\n<p>This gives us an implementation of Chain Signatures on Aurora via a Solidity contract called <a href=\"https://github.com/aurora-is-near/chain-signatures-signer\" target=\"_blank\" rel=\"noopener noreferrer\">Chain Signatures Signer</a>.</p>\n<p>You can read more about it in the documentation about <a href=\"https://doc.aurora.dev/crosschain/chain-signatures\">Chain Signatures on Virtual Chains</a> and the repo's <code>README.md</code> itself.</p>\n<p>I believe that picture can convey the whole process in the best possible way, so here is it:</p>\n<!-- -->\n<img src=\"https://doc.aurora.dev/img/safe-btc/scheme-light.png\" alt=\"Docusaurus themed image\" class=\"themedComponent_zcmF themedComponent--light_PZnH\"><img src=\"https://doc.aurora.dev/img/safe-btc/scheme-dark.png\" alt=\"Docusaurus themed image\" class=\"themedComponent_zcmF themedComponent--dark_g7nS\">\n<p>So, we have our Safe Wallet with two signers – Safe User 1 and Safe User 2 assigned to it. We assume Safe User 1 is doing most of the actions, and Safe User 2 just needs to confirm the transaction.</p>\n<p>Let me repeat the steps from the image above in the text format here.\nThe first step is creating and signing the Bitcoin transaction:</p>\n<ol>\n<li>User 1 derives Safe account on Bitcoin with <a href=\"https://github.com/aurora-is-near/chain-signatures-js?tab=readme-ov-file#deriving-your-addresses-on-bitcoin\" target=\"_blank\" rel=\"noopener noreferrer\">derive_accounts.js</a>.</li>\n<li>Tops it up with some Bitcoin (could be done via <a href=\"https://app.near-intents.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Near Intents</a>)</li>\n<li>Prepares unsigned transaction with <a href=\"https://github.com/aurora-is-near/chain-signatures-js?tab=readme-ov-file#sending-transactions-to-bitcoin\" target=\"_blank\" rel=\"noopener noreferrer\">send_tx.js</a>.</li>\n<li>Submits it to Safe via Transaction Builder as a call to the <a href=\"https://github.com/aurora-is-near/chain-signatures-signer\" target=\"_blank\" rel=\"noopener noreferrer\">Chain Signatures Signer</a> contract and signs the proposal to execute it.</li>\n<li>User 2 also signs the proposal.</li>\n<li><code>sign</code> method is called on CS Signer.</li>\n<li>XCC subbaccount of CS Signer calls the MPC contract on NEAR.</li>\n<li>MPC contract propels <a href=\"https://explorer.mainnet.aurora.dev/tx/0xf5de2f24cd6d9f7d93e40df638c47bc07c25d014190da4f033a676ed96186b8e?tab=logs\" target=\"_blank\" rel=\"noopener noreferrer\">the callback</a> back to EVM with signed data.</li>\n</ol>\n<div class=\"theme-admonition theme-admonition-note admonition_lH1X alert alert--secondary\"><div class=\"admonitionHeading_SPjx\"><span class=\"admonitionIcon_ghVV\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></span>note</div><div class=\"admonitionContent_RARr\"><p>We already have <a href=\"https://github.com/aurora-is-near/chain-signatures-signer\" target=\"_blank\" rel=\"noopener noreferrer\">Chain Signatures Signer</a> contracts deployed to both Aurora Mainnet and Testnet: <a href=\"https://explorer.mainnet.aurora.dev/address/0xF7607CD922804DaA9D54d21349Dd6F9467098dDE\" target=\"_blank\" rel=\"noopener noreferrer\">Mainnet Signer</a>, <a href=\"https://explorer.testnet.aurora.dev/address/0x7e4F22F1eE20e01719ff1D986D116B04aBB2EE3f\" target=\"_blank\" rel=\"noopener noreferrer\">Testnet Signer</a></p></div></div>\n<p>And then second step - Relaying the transaction - is done:</p>\n<ol>\n<li>User 1 takes signed data</li>\n<li>Puts <code>big_affine</code> and <code>scalar</code> value back into <a href=\"https://github.com/aurora-is-near/chain-signatures-js?tab=readme-ov-file#sending-transactions-to-bitcoin\" target=\"_blank\" rel=\"noopener noreferrer\">send_tx.js</a>, whcih constructs a signed transaction with it.</li>\n<li><a href=\"https://github.com/aurora-is-near/chain-signatures-js?tab=readme-ov-file#sending-transactions-to-bitcoin\" target=\"_blank\" rel=\"noopener noreferrer\">send_tx.js</a> relays the transaction to Bitcoin network.</li>\n<li>RPC executes it.</li>\n<li>Token transfer happens on Bitcoin network.</li>\n</ol>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"how-it-works\">How it works<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#how-it-works\" class=\"hash-link\" aria-label=\"Direct link to How it works\" title=\"Direct link to How it works\">​</a></h2>\n<p>It is a pretty challenging task to explain everything in detail here.\nHere is a list of docs and resources that explain all parts needed to understand the demo perfectly:</p>\n<ul>\n<li><a href=\"https://doc.aurora.dev/crosschain/xcc/aurora-to-near/introduction\">XCC</a></li>\n<li><a href=\"https://doc.aurora.dev/crosschain/chain-signatures\">Chain Signatures on Virtual Chains</a> - fresh docs about how signing works on EVM side, it has integration instructions also.</li>\n<li><a href=\"https://docs.near.org/concepts/abstraction/chain-signatures\" target=\"_blank\" rel=\"noopener noreferrer\">NEAR Chain Signatures</a></li>\n<li><a href=\"https://github.com/near-examples/near-multichain/\" target=\"_blank\" rel=\"noopener noreferrer\">NEAR Multichain Examples</a></li>\n</ul>\n<p>I have created the next two repos here to make this demo happen:</p>\n<ul>\n<li><a href=\"https://github.com/aurora-is-near/chain-signatures-signer\" target=\"_blank\" rel=\"noopener noreferrer\">Chain Signatures Signer</a> - Solidity contract to <code>sign</code> your payload on NEAR MPC from EVM.</li>\n<li><a href=\"https://github.com/aurora-is-near/chain-signatures-js\" target=\"_blank\" rel=\"noopener noreferrer\">Chain Signatures JS Lib</a> - some tools to derive accounts and relay the transaction taken from <a href=\"https://github.com/near-examples/near-multichain/\" target=\"_blank\" rel=\"noopener noreferrer\">NEAR Multichain Examples</a></li>\n</ul>\n<p>Feel free to reach me out on <a href=\"https://discord.com/invite/WXfbGsSUbT\" target=\"_blank\" rel=\"noopener noreferrer\">Discord</a>; just mention @slava there, if you will have any questions.</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"chain-signatures-signer\">Chain Signatures Signer<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#chain-signatures-signer\" class=\"hash-link\" aria-label=\"Direct link to Chain Signatures Signer\" title=\"Direct link to Chain Signatures Signer\">​</a></h3>\n<p>What is the main thing this contract does?</p>\n<ul>\n<li>It calls the MPC service on NEAR and <a href=\"https://explorer.mainnet.aurora.dev/tx/0x019fbf6ee6aad1edf9c68ab6cc04b8eba16479a724a1d6a9c741c5d04849c3cd\" target=\"_blank\" rel=\"noopener noreferrer\">signs your payload</a>.</li>\n<li>Then it propagates <a href=\"https://explorer.mainnet.aurora.dev/tx/0xf5de2f24cd6d9f7d93e40df638c47bc07c25d014190da4f033a676ed96186b8e?tab=logs\" target=\"_blank\" rel=\"noopener noreferrer\">the response</a> back to the EVM.</li>\n</ul>\n<p>It is done via the <code>sign</code> function call and receiving the response in the <code>signCallback</code> transaction.</p>\n<h4 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"sign-function\">Sign function<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#sign-function\" class=\"hash-link\" aria-label=\"Direct link to Sign function\" title=\"Direct link to Sign function\">​</a></h4>\n<p>To call <code>sign</code> you will need to provide:</p>\n<ul>\n<li><code>payload</code> - the data to be signed</li>\n<li><code>version</code> - <code>key_version</code> from chain signatures, check NEAR docs. At the moment, it is just 0.</li>\n<li><code>attachedNear</code> - the amount of wNEAR to attach to the NEAR call. Usually, 1yoctoNEAR is enough, so you should just enter 1.</li>\n</ul>\n<p>The code for the <code>sign</code> method looks like this:</p>\n<div class=\"language-solidity codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-solidity codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">sign</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token builtin\">string</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> payload</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token builtin\">uint256</span><span class=\"token plain\"> version</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token builtin\">uint128</span><span class=\"token plain\"> attachedNear</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">public</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token builtin\">bytes</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> _data </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">hexStringToBytes</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">payload</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">require</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">_data</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">length </span><span class=\"token operator\" style=\"color:#393A34\">==</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">32</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"Payload must be 32 bytes\"</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// path is fixed here to make sure only msg.sender can use the derived </span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// address via chain signature's of the xcc sub-account</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token builtin\">string</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> path </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">addressToString</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">msg</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">sender</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token builtin\">bytes</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> data </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">createData</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">_data</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> path</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> version</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        PromiseCreateArgs </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> callSign </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> near</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">call</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">signer</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"sign\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> data</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> attachedNear</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\">  SIGN_NEAR_GAS</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        PromiseCreateArgs </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> callback </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> near</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">auroraCall</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token builtin\">address</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token keyword\" style=\"color:#00009f\">this</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> abi</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">encodeWithSelector</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token keyword\" style=\"color:#00009f\">this</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">signCallback</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">selector</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> SIGN_CALLBACK_NEAR_GAS</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        callSign</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">then</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">callback</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">transact</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>The main moments to focus on are:</p>\n<ul>\n<li><strong>Ownership Preservation</strong>: The derivation path is equal to <code>addressToString(msg.sender);</code> which ensures that only the EOA or contract who is <code>msg.sender</code> can operate the derived account on other networks.</li>\n<li><strong>Callback is optional</strong>: you can remove it and index the NEAR blockchain instead for the MPC response. It will save you some gas if you don't need the signed message back into your Solidity contracts.</li>\n<li><strong>Gas for signature</strong>: <code>SIGN_NEAR_GAS</code> value can change in the future and be optimized. Right now, it is 50TGas.</li>\n</ul>\n<p>Here is <a href=\"https://explorer.mainnet.aurora.dev/tx/0x019fbf6ee6aad1edf9c68ab6cc04b8eba16479a724a1d6a9c741c5d04849c3cd\" target=\"_blank\" rel=\"noopener noreferrer\">the transaction with <code>sign</code> call</a> in it.</p>\n<h4 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"sign-callback\">Sign callback<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#sign-callback\" class=\"hash-link\" aria-label=\"Direct link to Sign callback\" title=\"Direct link to Sign callback\">​</a></h4>\n<p>Function <code>signCallback</code> just propagates the MPC response back inside EVM and emits <code>SignedEvent</code>:</p>\n<div class=\"language-solidity codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-solidity codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">signCallback</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">public</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">onlyRole</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">CALLBACK_ROLE</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        PromiseResult </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> result </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> AuroraSdk</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">promiseResult</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">result</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">status </span><span class=\"token operator\" style=\"color:#393A34\">!=</span><span class=\"token plain\"> PromiseResultStatus</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">Successful</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#00009f\">revert</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token string\" style=\"color:#e3116c\">\"SignCallback failed\"</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token builtin\">string</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> output </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token builtin\">string</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">result</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">output</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">emit</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">SignedEvent</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">output</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>The output will contain the <code>affine_point</code> and <code>scalar</code> to reconstruct the signature. You can take a look at the <a href=\"https://explorer.mainnet.aurora.dev/tx/0xf5de2f24cd6d9f7d93e40df638c47bc07c25d014190da4f033a676ed96186b8e?tab=logs\" target=\"_blank\" rel=\"noopener noreferrer\">example of such transaction</a>.</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"chain-signatures-js-lib\">Chain Signatures JS Lib<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#chain-signatures-js-lib\" class=\"hash-link\" aria-label=\"Direct link to Chain Signatures JS Lib\" title=\"Direct link to Chain Signatures JS Lib\">​</a></h3>\n<p>This lib is just a bunch of Node JS scripts to help you with NEAR Chain Signatures:</p>\n<ul>\n<li>Allows to derive BTC addresses on Mainnet and Testnet</li>\n<li>Create transactions for BTC transfers</li>\n</ul>\n<h4 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"deriving-your-addresses-on-bitcoin\">Deriving your addresses on Bitcoin<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#deriving-your-addresses-on-bitcoin\" class=\"hash-link\" aria-label=\"Direct link to Deriving your addresses on Bitcoin\" title=\"Direct link to Deriving your addresses on Bitcoin\">​</a></h4>\n<p>Just go to <code>src/derive_account.js</code> and enter if you want to use mainnet or testnet, your NEAR address, and derivation path:</p>\n<div class=\"language-js codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token comment\" style=\"color:#999988;font-style:italic\">//Example</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">const</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#36acaa\">BTC</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\">Bitcoin</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token string\" style=\"color:#e3116c\">'mainnet'</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// &lt;- mainnet</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">const</span><span class=\"token plain\"> account </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">'f7607cd922804daa9d54d21349dd6f9467098dde.aurora'</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// &lt;- XCC subaccount address, but you can use yours .near account instead</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">let</span><span class=\"token plain\"> path </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">'0x70ebe9fbc4e9920b07a1f043b2bede8fc2e09504'</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// &lt;-- derivation path, could be any seed, like 'bitcoin-1', 'bitcoin-2', etc. But in Safe BTC Demo we need it to correspond to the address on Aurora.</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Now you can execute it:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">node src/derive_account.js</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>You will get your account primary data, balance and UTXOs.\nRead more about <a href=\"https://github.com/aurora-is-near/chain-signatures-js?tab=readme-ov-file#deriving-your-addresses-on-bitcoin\" target=\"_blank\" rel=\"noopener noreferrer\">account derivation</a>.</p>\n<h4 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"sending-the-transaction\">Sending the transaction<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#sending-the-transaction\" class=\"hash-link\" aria-label=\"Direct link to Sending the transaction\" title=\"Direct link to Sending the transaction\">​</a></h4>\n<p>Now, you can take the derived account data and use it inside <code>src/send_tx.js</code> script.</p>\n<p>It was designed to execute a BTC transfer between two accounts.</p>\n<p>Enter your data into some struct like:</p>\n<div class=\"language-js codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token keyword\" style=\"color:#00009f\">const</span><span class=\"token plain\"> safe_account </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#36acaa\">address</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">'bc1qunau3q49dqewseky6nl9dqmq5fjsjfxmlkht8k'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#36acaa\">publicKey</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">'02ac2ac40a97879c728d0f9830996793b130aa5be0cf41f796ac7afcf739a72649'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#36acaa\">nearAccount</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">'f7607cd922804daa9d54d21349dd6f9467098dde.aurora'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token literal-property property\" style=\"color:#36acaa\">path</span><span class=\"token operator\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">'0x70ebe9fbc4e9920b07a1f043b2bede8fc2e09504'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>You should also prepare the data for BTC transfer in these variables (around line 40):</p>\n<div class=\"language-js codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token keyword\" style=\"color:#00009f\">const</span><span class=\"token plain\"> sats </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">10000</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// &lt;-- amount of Satoshis to transfer</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">const</span><span class=\"token plain\"> path </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> safe_account</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token property-access\">path</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// &lt;-- derivation path of source account</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">const</span><span class=\"token plain\"> pkey </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> safe_account</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token property-access\">publicKey</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// &lt;-- pubkey of source account</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">const</span><span class=\"token plain\"> toAddress </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">'14secnpokXzrjRa3fEwcJ1RQKusCp3kTUA'</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// &lt;-- destination address</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Now, you're ready to send the transaction:</p>\n<div class=\"language-bash codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">node src/send_tx.js </span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>After that, you will need:</p>\n<ol>\n<li>To sign it via a call to <a href=\"https://github.com/aurora-is-near/chain-signatures-signer\" target=\"_blank\" rel=\"noopener noreferrer\">Chain Signatures Signer</a> contract.</li>\n<li>To put the signed data back into your terminal.</li>\n</ol>\n<p>Then, a transaction will be relayed and executed on the Bitcoin network.</p>\n<p>Read more about <a href=\"https://github.com/aurora-is-near/chain-signatures-js?tab=readme-ov-file#sending-transactions-to-bitcoin\" target=\"_blank\" rel=\"noopener noreferrer\">relaying transactions</a>.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"outro\">Outro<a href=\"https://doc.aurora.dev/blog/safe-bitcoin-demo#outro\" class=\"hash-link\" aria-label=\"Direct link to Outro\" title=\"Direct link to Outro\">​</a></h2>\n<p>That is it! Thank you for reading the article! I hope you liked it and learned a lot today!</p>\n<p>Happy developing on virtual chains!</p>\n<p>If you have any questions or suggestions, please visit our <a href=\"https://discord.com/invite/WXfbGsSUbT\" target=\"_blank\" rel=\"noopener noreferrer\">Discord Community</a>!</p>",
            "url": "https://doc.aurora.dev/blog/safe-bitcoin-demo",
            "title": "Safe Wallet and Aurora: multisigs for Bitcoin",
            "summary": "By using NEAR Chain Signatures and Aurora we demonstrate how Safe Wallet could control Bitcoin account operations",
            "date_modified": "2025-02-07T00:00:00.000Z",
            "author": {
                "name": "Slava Karkunov"
            },
            "tags": [
                "Tutorials"
            ]
        },
        {
            "id": "https://doc.aurora.dev/blog/how-to-bridge-liquidity-to-aurora",
            "content_html": "<p>In this article, we will discuss how to bridge liquidity to Aurora in the most convenient way. We will focus on stablecoins, explain why we have four types of these on Aurora, and take a look at how to bridge them in different ways. Note that this whole bridging process also applies to the ERC-20 tokens.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"the-global-picture--what-stables-do-we-have\">The global picture – What stables do we have?<a href=\"https://doc.aurora.dev/blog/how-to-bridge-liquidity-to-aurora#the-global-picture--what-stables-do-we-have\" class=\"hash-link\" aria-label=\"Direct link to The global picture – What stables do we have?\" title=\"Direct link to The global picture – What stables do we have?\">​</a></h2>\n<p>First, let’s mention three main actors here: Ethereum, Near, and Aurora blockchains. Second, we will consider the two most popular stables, USDC and USDT. To connect the ecosystem, we will use the Rainbow Bridge.<br>\n<br>\n<!-- -->Let’s take a look at how USDC and USDT tokens are bridged via Rainbow Bridge from Ethereum to Near:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1716383440-screenshot-2024-05-21-at-11-51-56.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>As you can see, Near has the corresponding bridged versions of Ethereum’s tokens: USDC.e and USDT.e (in green), as well as the Near native <a href=\"https://nearblocks.io/address/17208628f84f5d6ad33f0da3bbbeb27ffcb398eac501a31bd6ad2011e36133a1\" target=\"_blank\" rel=\"noopener noreferrer\"><em>USDC</em></a> and <a href=\"https://nearblocks.io/address/usdt.tether-token.near\" target=\"_blank\" rel=\"noopener noreferrer\"><em>USDT</em></a> (in blue).</p>\n<p>This is needed to separate the bridged liquidity from the native one on the Near blockchain. You may also have heard about such tokens being wrapped. All these versions are interchangeable using <a href=\"https://app.ref.finance/#a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48.factory.bridge.near%7C17208628f84f5d6ad33f0da3bbbeb27ffcb398eac501a31bd6ad2011e36133a1\" target=\"_blank\" rel=\"noopener noreferrer\"><em>ref.finance,</em></a> on Near Protocol, as depicted by a green arrow in the image.</p>\n<p>A similar story repeats with Aurora by bridging tokens from Ethereum and Near via Rainbow Bridge. So we’re getting the next picture:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1716383465-screenshot-2024-05-21-at-11-53-42.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>That is why, on Aurora, we have 4 different tokens representing stables. USDC and USDT tokens are the wrapped analog for the Near native tokens. And USDC.e and USDT.e – for the Ethereum tokens. All these versions are interchangeable by using <a href=\"https://aurora.plus/swap\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Aurora+ Swap</em></a> feature supported by 1inch.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"how-to-transfer-liquidity-to-aurora\">How to transfer liquidity to Aurora?<a href=\"https://doc.aurora.dev/blog/how-to-bridge-liquidity-to-aurora#how-to-transfer-liquidity-to-aurora\" class=\"hash-link\" aria-label=\"Direct link to How to transfer liquidity to Aurora?\" title=\"Direct link to How to transfer liquidity to Aurora?\">​</a></h2>\n<p>As you have seen in the picture above, the most natural way to transfer tokens from Ethereum or Near is to use the <a href=\"https://rainbowbridge.app/\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Rainbow Bridge</em></a>. But we will talk about other variants too. Here is a picture summarizing the most popular ones:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1716383517-screenshot-2024-05-21-at-11-16-27.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>If you have tokens on CEX that support Near, you can use <a href=\"https://doc.aurora.dev/launch-chain/forwarder/introduction\" target=\"_blank\" rel=\"noopener noreferrer\">Forwarder</a>, which allows you to transfer them from CEX to your Aurora address. See Binance instructions <a href=\"https://doc.aurora.dev/launch-chain/forwarder/how-to-use/binance\" target=\"_blank\" rel=\"noopener noreferrer\">here</a>.</p>\n<p>For any other EVMs, you can use the <a href=\"https://stargate.finance/\" target=\"_blank\" rel=\"noopener noreferrer\">Stargate</a> (coming soon) or <a href=\"https://meson.fi/\" target=\"_blank\" rel=\"noopener noreferrer\">Meson</a> bridges. Stargate supports the Near Native USDC pool on Aurora. You can always <a href=\"https://aurora.plus/swap\" target=\"_blank\" rel=\"noopener noreferrer\"><em>swap you tokens on Aurora+</em></a>, after bridging.<br>\n<br>\n<!-- -->That is it! Thank you for reading us!<br>\n<!-- -->If you have any questions or suggestions, please visit our <a href=\"https://discord.com/invite/WXfbGsSUbT\" target=\"_blank\" rel=\"noopener noreferrer\">Discord Community</a>!</p>",
            "url": "https://doc.aurora.dev/blog/how-to-bridge-liquidity-to-aurora",
            "title": "How to bridge liquidity to Aurora?",
            "summary": "We will focus on stablecoins, explain their types on Aurora, and take a look at how to bridge them in different ways from other ecosystems",
            "date_modified": "2024-05-22T00:00:00.000Z",
            "author": {
                "name": "Slava Karkunov"
            },
            "tags": [
                "Tutorials"
            ]
        },
        {
            "id": "https://doc.aurora.dev/blog/hot-to-get-your-tokens-from-bastion-contract",
            "content_html": "<p>Recently, we became aware of this issue and the lack of a way to do it in the Bastion UI, so we decided to create a tutorial for everyone to use independently. Big thanks to the people in the community who helped me create and test this tutorial and provided invaluable insights and feedback!</p>\n<p>To formulate the problem more precisely, a user has some <code>cUSDCcUSDTLP</code> tokens and wants to convert these back to stables. The Bastion project's UI doesn't allow this today, so the only way is to call smart contracts directly.</p>\n<p>We will go through the next steps:</p>\n<ul>\n<li>What contracts should we call?</li>\n<li>What method should we call, and how?</li>\n<li>How to convert <code>cUSDC</code> and <code>cUSDT</code> into regular stables?</li>\n</ul>\n<p>We will use the most convenient way for users to interact with smart contracts—the Explorer. However, devs can always write a script to perform the steps described in this article with Ethers or Web3.js.</p>\n<p>Let's go!</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"what-contracts\">What contracts?<a href=\"https://doc.aurora.dev/blog/hot-to-get-your-tokens-from-bastion-contract#what-contracts\" class=\"hash-link\" aria-label=\"Direct link to What contracts?\" title=\"Direct link to What contracts?\">​</a></h2>\n<p>The main actor of this article will be <a href=\"https://explorer.aurora.dev/address/0x6287e912a9Ccd4D5874aE15d3c89556b2a05f080?tab=write_contract\" target=\"_blank\" rel=\"noopener noreferrer\"><code>SwapFlashLoan</code> contract</a>:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715902943-screenshot-2024-05-17-at-00-39-24.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>The plan is:</p>\n<ol>\n<li>Approve <a href=\"https://explorer.aurora.dev/address/0x0039f0641156cac478b0DebAb086D78B66a69a01?tab=write_proxy\" target=\"_blank\" rel=\"noopener noreferrer\">cUSDCcUSDTLP token</a> to be used by the <code>SwapFlashLoan</code> contract.</li>\n<li>Get cUSDC and cUSDT from <code>SwapFlashLoan</code>.</li>\n<li>Redeem <a href=\"https://explorer.aurora.dev/token/0xe5308dc623101508952948b141fD9eaBd3337D99\" target=\"_blank\" rel=\"noopener noreferrer\">cUSDC</a> and <a href=\"https://explorer.mainnet.aurora.dev/address/0x845E15A441CFC1871B7AC610b0E922019BaD9826\" target=\"_blank\" rel=\"noopener noreferrer\">cUSDT</a> from their contracts to get stables.</li>\n</ol>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"approve-cusdccusdtlp\">Approve cUSDCcUSDTLP<a href=\"https://doc.aurora.dev/blog/hot-to-get-your-tokens-from-bastion-contract#approve-cusdccusdtlp\" class=\"hash-link\" aria-label=\"Direct link to Approve cUSDCcUSDTLP\" title=\"Direct link to Approve cUSDCcUSDTLP\">​</a></h2>\n<p>Let's start with connecting your wallet. To do this, please open <a href=\"https://explorer.aurora.dev/address/0x0039f0641156cac478b0DebAb086D78B66a69a01?tab=write_proxy\" target=\"_blank\" rel=\"noopener noreferrer\">cUSDCcUSDTLP token contract</a> and click Contract -&gt; Write Contract -&gt; Connect Wallet:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715948365-screenshot-2024-05-17-at-13-19-16.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Then you will see the next popup to connect your wallet:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715903570-screenshot-2024-05-17-at-00-52-39.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>We recommend using <a href=\"https://auroracloud.dev/pass\" target=\"_blank\" rel=\"noopener noreferrer\">the Aurora Pass wallet</a>, which you can connect via the Wallet Connect option above and a QR code. It offers 50 free transactions a month on the Aurora blockchain and is a very user-friendly mobile wallet.</p>\n<p>After connecting it, we're ready to move further.<br>\n<br>\n<!-- -->If you scroll down, you will see the contract methods, and here is the one we need – <code>approve</code> and enter the arguments there with <code>spender</code> being the <code>swapFlashLoan</code> contract address and <code>amount</code> equal to the number of tokens you want to get back (probably all you have right now):</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715948641-screenshot-2024-05-17-at-13-22-10.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Now, we're ready to execute the transaction, just click the \"Write\" button on the right and confirm it in your wallet!</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"get-cusdc-and-cusdt\">Get cUSDC and cUSDT<a href=\"https://doc.aurora.dev/blog/hot-to-get-your-tokens-from-bastion-contract#get-cusdc-and-cusdt\" class=\"hash-link\" aria-label=\"Direct link to Get cUSDC and cUSDT\" title=\"Direct link to Get cUSDC and cUSDT\">​</a></h2>\n<p>Let's open now the <a href=\"https://explorer.aurora.dev/address/0x6287e912a9Ccd4D5874aE15d3c89556b2a05f080?tab=write_contract\" target=\"_blank\" rel=\"noopener noreferrer\"><code>SwapFlashLoan</code> contract</a>. Go to the Contract -&gt; Write Contract tab. If you scroll down, you will see the contract methods, and here is the one we need – <code>removeLiquidity</code>:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715903828-screenshot-2024-05-17-at-00-56-14.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>We're unsure about the arguments here yet, so let's find out what values we should use. To do this, we will look at one such transaction, which has already been executed by someone. We need to find it in history. So here is <a href=\"https://explorer.aurora.dev/tx/0x0b079aee0e1feae4c10e127a5535877baee23567f22bc5293a5f885ba8d249f9\" target=\"_blank\" rel=\"noopener noreferrer\">one</a>:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715903950-screenshot-2024-05-17-at-00-58-43.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>You can see what exactly has happened here during the execution in terms of the token transfers:</p>\n<ul>\n<li><code>cUSDCcUSDTLP</code> tokens were burned</li>\n<li><code>cUSDT</code> and <code>cUSDC</code> tokens were transferred to the caller</li>\n</ul>\n<p>Now, let's scroll down a bit and click on \"View details\" link at the left bottom of the page, you will see the arguments of the method used there:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715904026-screenshot-2024-05-17-at-00-58-57.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>We can conclude by looking at the both screenshots above that:</p>\n<ol>\n<li><code>amount</code> argument is equal to your <code>cUSDCcUSDTLP</code> tokens amount with 18 decimals added. E.g. in this case, the user has 2021.941835489438, so the correct value should be 2021294184354893800000. You can use <a href=\"https://www.eth-to-wei.com/\" target=\"_blank\" rel=\"noopener noreferrer\">this tool</a> to convert your values.</li>\n<li><code>deadline</code> is your time now, with 20 minutes added to it in a timestamp format. You can use <a href=\"https://www.epochconverter.com/\" target=\"_blank\" rel=\"noopener noreferrer\">the EpochConverter</a> tool to get the correct value. Just add 20 minutes to the datetime there and copy-paste the timestamp value.</li>\n<li>The first value in <code>minAmounts</code> corresponds to the <code>cUSDT</code> token amount transferred back, and the second one is for the <code>cUSDC</code>. They have 8 decimals, and if you sum them up, you will get your amount of <code>cUSDCcUSDTLP</code> tokens. So you can just enter any values which in sum give you a value smaller or equal to the <code>amount</code>.</li>\n</ol>\n<p>We're ready to execute the method now. Just enter the correct arguments to your Explorer tab, it should look like this:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715907308-screenshot-2024-05-17-at-01-54-36.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>After that, just click the \"Write\" button and confirm the transaction in your wallet.<br>\n<!-- -->That is it! Now you got back your <code>cUSDC</code> and <code>cUSDT</code> tokens.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"how-to-convert-ctokens-to-stables\">How to convert cTokens to stables?<a href=\"https://doc.aurora.dev/blog/hot-to-get-your-tokens-from-bastion-contract#how-to-convert-ctokens-to-stables\" class=\"hash-link\" aria-label=\"Direct link to How to convert cTokens to stables?\" title=\"Direct link to How to convert cTokens to stables?\">​</a></h2>\n<p>To do this, we will need to point our attention to these contracts:</p>\n<ul>\n<li>cUSDT: <a href=\"https://explorer.mainnet.aurora.dev/address/0x845E15A441CFC1871B7AC610b0E922019BaD9826\" target=\"_blank\" rel=\"noopener noreferrer\">0x845E15A441CFC1871B7AC610b0E922019BaD9826</a></li>\n<li>cUSDC: <a href=\"https://explorer.aurora.dev/token/0xe5308dc623101508952948b141fD9eaBd3337D99\" target=\"_blank\" rel=\"noopener noreferrer\">0xe5308dc623101508952948b141fD9eaBd3337D99</a></li>\n</ul>\n<p>For both of them, the process will look the same, so let's just talk about <code>cUSDT</code> case. To unwrap you need to call this method – `redeem`:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715907708-screenshot-2024-05-17-at-02-01-35.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>It has only one argument, which is the amount of tokens to unwrap with 8 decimals added to it. So, for <a href=\"https://explorer.aurora.dev/tx/0x0b079aee0e1feae4c10e127a5535877baee23567f22bc5293a5f885ba8d249f9\" target=\"_blank\" rel=\"noopener noreferrer\">the transaction from the previous section</a>, it should be 167994638559. It is the amount of the <code>cUSDT</code> tokens you have received after your <code>removeLiquidity</code> call.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"final-thoughts\">Final thoughts<a href=\"https://doc.aurora.dev/blog/hot-to-get-your-tokens-from-bastion-contract#final-thoughts\" class=\"hash-link\" aria-label=\"Direct link to Final thoughts\" title=\"Direct link to Final thoughts\">​</a></h2>\n<p>That is it – you have successfully got your <code>cUSDCcUSDTLP</code> tokens converted back to stables. If you need any help or have a similar issue, please come <a href=\"https://discord.com/invite/dEFJBz8HQV\" target=\"_blank\" rel=\"noopener noreferrer\">to our Discord</a>, and we will help you! Thank you for reading!\\</p>",
            "url": "https://doc.aurora.dev/blog/hot-to-get-your-tokens-from-bastion-contract",
            "title": "How to get your tokens from Bastion contracts?",
            "summary": "In this article, you will learn how you can retrieve the stables from Bastion by using Aurora Explorer to call its smart contracts",
            "date_modified": "2024-05-17T00:00:00.000Z",
            "author": {
                "name": "Slava Karkunov"
            },
            "tags": [
                "Tutorials"
            ]
        },
        {
            "id": "https://doc.aurora.dev/blog/managing-aurora-s-validator-staking-with-near-cli-rs",
            "content_html": "<p>In this article, we will discuss how to manage your staking on the Aurora Validator. To recap quickly, Aurora is an EVM-compatible blockchain running as an L2 on the Near Protocol. In the heart of it is an Aurora Engine smart contract. That is why every transaction on Aurora is relayed to the Near and has the corresponding Near transaction. You can read more about this <a href=\"https://doc.aurora.dev/blog/convert-aurora-transaction-into-near-s-one\"><em>here</em></a>. That is why Aurora doesn’t have its own validators – we’re just re-using the Near ones.</p>\n<p>In January 2023, we re-launched <a href=\"https://aurora.dev/blog/aurora-relaunches-its-validator\" target=\"_blank\" rel=\"noopener noreferrer\"><em>our validator</em></a> with a new address, <a href=\"https://app.mynearwallet.com/staking/aurora.pool.near\" target=\"_blank\" rel=\"noopener noreferrer\"><em>aurora.pool.near</em></a>. What is curious about it is that it gives you the rewards in AURORA tokens directly on the Near network.</p>\n<p>Recently, the <a href=\"https://near.org/blog/embracing-decentralization-whats-next-for-the-near-wallet\" target=\"_blank\" rel=\"noopener noreferrer\"><em>Near Wallet was deprecated</em></a> on the 1st of January, 2024. And that has driven users to other wallets. Unfortunately, many of these don’t support staking capabilities, especially with the non-standard validator as `aurora.pool.near` is.</p>\n<p>So, based on the recent support experience, we have decided to publish a guide on how to use your terminal on your laptop or PC to manage your staking on the Aurora’s Validator. Let’s look into the details now!</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"installing-near-cli-rs\">Installing `near-cli-rs`<a href=\"https://doc.aurora.dev/blog/managing-aurora-s-validator-staking-with-near-cli-rs#installing-near-cli-rs\" class=\"hash-link\" aria-label=\"Direct link to Installing `near-cli-rs`\" title=\"Direct link to Installing `near-cli-rs`\">​</a></h2>\n<p>Near CLI is your human-friendly companion that helps to interact with Near Protocol from the terminal right away. There are multiple ways to install it, see <a href=\"https://github.com/near/near-cli-rs?tab=readme-ov-file#install\" target=\"_blank\" rel=\"noopener noreferrer\"><em>here</em></a>. I am using Mac, so I will choose the first option and execute in my Terminal:</p>\n<div class=\"language-shell codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-shell codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">curl --proto '=https' --tlsv1.2 -LsSf https://github.com/near/near-cli-rs/releases/latest/download/near-cli-rs-installer.sh | sh </span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>You can also run it as an npm package:</p>\n<div class=\"language-undefined codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-undefined codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">npx near-cli-rs </span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>After installation, if you execute <code>near</code> command you should be able to see this screen:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714679129-screenshot-2024-05-02-at-20-45-17.png\" alt=\"\" class=\"img__pfF\"></p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"connecting-your-account\">Connecting your account<a href=\"https://doc.aurora.dev/blog/managing-aurora-s-validator-staking-with-near-cli-rs#connecting-your-account\" class=\"hash-link\" aria-label=\"Direct link to Connecting your account\" title=\"Direct link to Connecting your account\">​</a></h2>\n<p>Now, let's connect your account to the near-cli-rs. To do this, execute the near command and choose the account option, which you've seen in the previous screenshot above, using the <code>Enter</code> key.</p>\n<p>You will see the next screen saying <code>What do you want to do with an account?</code>. Choose the <code>import-account</code> option there and press <code>Enter</code>:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714679473-screenshot-2024-04-26-at-12-12-20.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>You will see a screen with different import options:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714679597-screenshot-2024-05-02-at-20-52-57.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Choose one that fits you! I will try to use <code>using-web-wallet</code> option. The browser window with <a href=\"https://app.mynearwallet.com/\" target=\"_blank\" rel=\"noopener noreferrer\">https://app.mynearwallet.com/</a> will be opened, and you will see a popup asking for your permission to connect:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714679775-screenshot-2024-04-26-at-12-13-22.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Click the <code>Connect</code> button to approve. After that, you will need to confirm this choice by typing your full account name into the popup:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714680087-screenshot-2024-05-02-at-20-59-05.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Then, you will get the next alert about successful authorization:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714680117-screenshot-2024-05-02-at-20-59-31.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Now, you can go back to your terminal window, and you will see a message asking you to enter your account name again:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714680166-screenshot-2024-05-02-at-21-00-07.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Enter it there and press <code>Enter</code>. After that, choose a keychain to store your keys. I am choosing the first option there:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714679837-screenshot-2024-04-26-at-12-14-36.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>You will get the final message that `... access key is saved in the keychain` and a console command that can replace this manual process of choosing different options in the future:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714680238-screenshot-2024-05-02-at-21-00-41.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>So, all of the things we did here could be achieved also with this command:</p>\n<div class=\"language-shell codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-shell codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near account import-account using-web-wallet network-config mainnet</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>That is great! As you can see, <code>near-cli-rs</code> is teaching you the terminal commands automatically while exploring it!<br>\n<br>\n<!-- -->You have added your Near account to <code>near-cli-rs</code>, and it is now ready to be used.<br>\n<!-- -->Let's try it to stake some tokens on the Aurora Validator!</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"staking-tokens\">Staking tokens<a href=\"https://doc.aurora.dev/blog/managing-aurora-s-validator-staking-with-near-cli-rs#staking-tokens\" class=\"hash-link\" aria-label=\"Direct link to Staking tokens\" title=\"Direct link to Staking tokens\">​</a></h2>\n<p>TLDR: to stake your tokens, you need to use the next command:</p>\n<div class=\"language-shell codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-shell codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near staking delegation karkunow.near \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     deposit-and-stake '1 NEAR' \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     aurora.pool.near network-config mainnet \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     sign-with-keychain send</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Let's review the rest of the section to learn the details about how it works with <code>near-cli</code>.<br>\n<br>\n<!-- -->First, make sure you know what validator you will use to stake. You can check the list of validators with this command:</p>\n<div class=\"language-shell codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-shell codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near staking validator-list network-config mainnet</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>I, of course, will use <code>aurora.pool.near</code> for this demo.</p>\n<p>To stake your tokens, start with executing the <code>near</code> command and choosing the <code>staking</code> option from the list:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714681089-screenshot-2024-05-02-at-21-14-10.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Now, choose <code>delegation</code>:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714681106-screenshot-2024-05-02-at-21-14-23.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>And type your Near account into the console and press Enter. In my case, I have it already listed, so I will just choose mine from the list:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714681129-screenshot-2024-05-02-at-21-14-38.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>After that, you need to choose <code>deposit-and-stake</code> (not just <code>stake</code> or <code>stake-all</code>, these options won't work if your tokens were not deposited to the validator yet):</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715217828-screenshot-2024-05-09-at-02-19-05.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Then, enter the amount of NEAR tokens to be staked, I am entering 1NEAR for the purpose of this demo:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715218002-screenshot-2024-05-09-at-02-15-57.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Now, type in your validator address or choose from the list (you can use the <code>tab</code> key to autocomplete):</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715218061-screenshot-2024-05-09-at-02-16-28.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Choose the network now, I will opt for the <code>mainnet</code>:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715218288-screenshot-2024-05-09-at-02-16-56.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>After this, you will see your transaction formed and ready to be signed. By default, I am signing it with my keychain:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715218347-screenshot-2024-05-09-at-02-17-12.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Now, you can <code>send</code> the transaction and execute it:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715218434-screenshot-2024-05-09-at-02-17-47.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>You will see the transaction ID and a link to the Explorer after the successful execution:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715218479-screenshot-2024-05-09-at-02-19-35.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>We can visit the Explorer link to see the details of the transaction:</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"unstaking-tokens\">Unstaking tokens<a href=\"https://doc.aurora.dev/blog/managing-aurora-s-validator-staking-with-near-cli-rs#unstaking-tokens\" class=\"hash-link\" aria-label=\"Direct link to Unstaking tokens\" title=\"Direct link to Unstaking tokens\">​</a></h2>\n<p>TLDR: You just need to use the next command, which is really similar to the one used for staking:</p>\n<div class=\"language-undefined codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-undefined codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near staking delegation karkunow.near \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     unstake-all \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     aurora.pool.near network-config mainnet \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     sign-with-keychain send</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>If you don't want to unstake all the funds, just use the <code>unstake</code> option and enter the amount of NEAR tokens you want to get back.</p>\n<p>Now, let's go through a few screenshots to understand better how I got this command from the <code>near-cli-rs</code>. As we have learned from the previous section, to manage our staking activities, we just execute:</p>\n<div class=\"language-shell codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-shell codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near staking delegation [your account here](your account here)</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Now, if you want to unstake your tokens – just choose the <code>unstake-all</code> or <code>unstake</code> option from the list:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715219903-screenshot-2024-05-09-at-02-53-21.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>After that, you will be guided through the same screens as for the staking to enter the amount, validator address, network config (mainnet or testnet), and then – sign and send it. After the execution, you will see:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715219915-screenshot-2024-05-09-at-02-52-57.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>Exactly the same command will be formed by <code>near-cli-rs</code> after that process. So now, you can use this shortcut instead.<br>\n<br>\n<!-- -->After unstaking, you will need to wait for the 4 epochs on Near blockchain to pass, which will take around 50-60 hours of time. And then, you will be ready to withdraw them and the associated rewards. The rewards will be automatically unlocked together with the unstaked tokens.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"withdrawing-tokens\">Withdrawing tokens<a href=\"https://doc.aurora.dev/blog/managing-aurora-s-validator-staking-with-near-cli-rs#withdrawing-tokens\" class=\"hash-link\" aria-label=\"Direct link to Withdrawing tokens\" title=\"Direct link to Withdrawing tokens\">​</a></h2>\n<p>I won't go into details with the screenshots here. Now, we're ready just to use the commands.</p>\n<p>So, to withdraw your tokens and rewards, you need to execute this:</p>\n<div class=\"language-undefined codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-undefined codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near staking delegation karkunow.near \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     withdraw-all \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     aurora.pool.near network-config mainnet \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     sign-with-keychain send</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>If you don't want to withdraw all the funds, just use `withdraw` and enter the amount of NEAR tokens you want to withdraw.</p>\n<p>After the execution, you will see:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1714681248-screenshot-2024-05-02-at-21-17-51.png\" alt=\"\" class=\"img__pfF\"></p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"claiming-on-auroras-validator\">Claiming on Aurora's validator<a href=\"https://doc.aurora.dev/blog/managing-aurora-s-validator-staking-with-near-cli-rs#claiming-on-auroras-validator\" class=\"hash-link\" aria-label=\"Direct link to Claiming on Aurora's validator\" title=\"Direct link to Claiming on Aurora's validator\">​</a></h2>\n<p>Aurora's validator allows you to farm the AURORA tokens instead of NEAR by staking NEAR on it. It is based <a href=\"https://github.com/referencedev/staking-farm/\" target=\"_blank\" rel=\"noopener noreferrer\">on this smart contract</a>. That is the reason why you need to use another way to claim these rewards in AURORA tokens. Can we do it with <code>near-cli-rs</code>? Yes! Let's see how it is done.<br>\n<br>\n<!-- -->I will use two variables to track the staking pool and account:</p>\n<div class=\"language-shell codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-shell codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">export STAKINGCONTRACT=aurora.pool.near &amp;&amp; \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">export MYACCOUNT=karkunow.near</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>To track how much tokens you have right now in staking you should execute:</p>\n<div class=\"language-undefined codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-undefined codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near contract call-function as-read-only aurora.pool.near \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     'get_unclaimed_reward' json-args \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     '{\"account_id\":\"'${MYACCOUNT}'\", \"farm_id\":0}' \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      network-config mainnet now</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>You will see the something similar to the next screen:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715334843-screenshot-2024-05-10-at-10-25-15.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>The value will be in Wei, so you need to convert it to get the real value of 0.0032 AURORA by multiplying it with 10^-18.</p>\n<p>To claim your rewards you need to call the <code>claim</code> method on <code>aurora.pool.near</code> contract:</p>\n<div class=\"language-undefined codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-undefined codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near contract call-function as-transaction aurora.pool.near \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     'claim' json-args \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     '{\"account_id\": \"'${MYACCOUNT}'\", \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">       \"token_id\": \"aaaaaa20d9e0e2461697782ef11675f668207961.factory.bridge.near\"}' \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     prepaid-gas '100.0 Tgas' attached-deposit '1 yoctoNEAR' \\</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     sign-as karkunow.near /</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     network-config mainnet /</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     sign-with-keychain / </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     send</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>We're passing the account and NEP-141 AURORA token address to the contract's <code>claim</code> method. Also we attach 100TGas of gas and deposit 1 yoctoNear to it.</p>\n<p>After the execution, you will get the transaction hash, which you can now track in the explorer:</p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https://www.datocms-assets.com/95026/1715335148-screenshot-2024-05-10-at-10-58-39.png\" alt=\"\" class=\"img__pfF\"></p>\n<p>That is it! You claimed your rewards from the Aurora Validator.</p>\n<p>If you want to dive deeper, you can read more docs about the <code>aurora.pool.near</code> methods <a href=\"https://github.com/referencedev/staking-farm/blob/master/HowTo.md\" target=\"_blank\" rel=\"noopener noreferrer\">here</a>.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"final-thoughts\">Final thoughts<a href=\"https://doc.aurora.dev/blog/managing-aurora-s-validator-staking-with-near-cli-rs#final-thoughts\" class=\"hash-link\" aria-label=\"Direct link to Final thoughts\" title=\"Direct link to Final thoughts\">​</a></h2>\n<p>Thank you for reading the article! We have learned a lot today!<br>\n<!-- -->We hope that <code>near-cli-rs</code> will be an indispensable tool for you while working with the Near ecosystem and that it will make it easier for you to interact with the blockchain.<br>\n<!-- -->See you in the next articles!</p>",
            "url": "https://doc.aurora.dev/blog/managing-aurora-s-validator-staking-with-near-cli-rs",
            "title": "Managing Aurora's Validator staking with 'near-cli-rs'",
            "summary": "Let's learn how to manage your staking with Near validators and claim your Aurora validator's rewards by using 'near-cli-rs'",
            "date_modified": "2024-05-10T00:00:00.000Z",
            "author": {
                "name": "Slava Karkunov"
            },
            "tags": [
                "Tutorials"
            ]
        },
        {
            "id": "https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near",
            "content_html": "<p>Some common functionality is required for many smart contracts. Examples are temporarily pausing certain features, staging and deploying a new version of the contract, and restricting access to contract methods. While such functionality is out of scope for an SDK like <code>near-sdk-rs</code>, ideally it is not implemented anew for every smart contract.</p>\n<p>The most obvious benefits of an open-source library are reusability and the value it adds to the ecosystem. The smart contract features mentioned above can be tricky to implement and cumbersome to test. Without a library, developers might gloss over functionality that does not add business value but still is critical for security. As <code>near-plugins</code> is open-source and used by many developers, there are more engineering hours and eyeballs dedicated to it compared to a solution specific to a single smart contract.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"case-study-a-counter-managing-permissions-with-acl\">Case study: A counter managing permissions with ACL<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#case-study-a-counter-managing-permissions-with-acl\" class=\"hash-link\" aria-label=\"Direct link to Case study: A counter managing permissions with ACL\" title=\"Direct link to Case study: A counter managing permissions with ACL\">​</a></h2>\n<p>Let’s look at a case study to see how <code>near-plugins</code> can be useful to smart contract developers. We are building a <code>Counter</code> that stores its current value and has methods to increment, decrement, and reset the value. It is intentionally kept simple to allow us to focus on how <code>near-plugins</code> adds functionality. This is what the contract looks like prior to using any plugins:</p>\n<div class=\"language-rust codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-rust codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[near_bindgen]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">impl</span><span class=\"token plain\"> </span><span class=\"token class-name\">Counter</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[init]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">new</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">-&gt;</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">Self</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">Self</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"> value</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// Anyone can retrieve the current value.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">value</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">-&gt;</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">i64</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">value</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// Increases the value of the counter by one.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">increment</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token keyword\" style=\"color:#00009f\">mut</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">value </span><span class=\"token operator\" style=\"color:#393A34\">+=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// Decreases the value of the counter by one.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">decrement</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token keyword\" style=\"color:#00009f\">mut</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">value </span><span class=\"token operator\" style=\"color:#393A34\">-=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// Resets the value of the counter to zero.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">reset</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token keyword\" style=\"color:#00009f\">mut</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">value </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>The final version of the code is available <a href=\"https://github.com/mooori/counter-acl-example\" target=\"_blank\" rel=\"noopener noreferrer\"><em>in this repository on github</em></a>. The <em><code>Counter</code></em> example is inspired by <a href=\"https://github.com/near-examples/counter-rust\" target=\"_blank\" rel=\"noopener noreferrer\"><em>near-examples/counter-rust</em></a>.</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"permissions\">Permissions<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#permissions\" class=\"hash-link\" aria-label=\"Direct link to Permissions\" title=\"Direct link to Permissions\">​</a></h3>\n<p>The contract methods defined above can be called by anyone since they are public and inside an implementation block marked with <code>#[near_bindgen]</code>. Using <code>near-sdk-rs</code> it is possible to restrict some methods such that they can be called only by the contract itself. Either by using <code>#[private]</code> or by not exposing the method publicly, as described in the <a href=\"https://docs.near.org/sdk/rust/contract-interface/private-methods\" target=\"_blank\" rel=\"noopener noreferrer\">documentation</a>.</p>\n<p>However, what if we wanted to implement more flexible permissions (e.g. allowing only some set of accounts to call a given function)? This is where the <a href=\"https://github.com/aurora-is-near/near-plugins#accesscontrollable\" target=\"_blank\" rel=\"noopener noreferrer\"><code>AccessControllable</code></a> plugin comes in handy.</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"managing-permissions-with-acl\">Managing permissions with ACL<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#managing-permissions-with-acl\" class=\"hash-link\" aria-label=\"Direct link to Managing permissions with ACL\" title=\"Direct link to Managing permissions with ACL\">​</a></h3>\n<p>ACL stands for <em>access control lists</em> and they are used in the following way within the <code>AccessControllable</code> plugin. The user defines the roles required for their use case as Rust enum variants. Then it is possible to restrict access to a method to accounts that have been granted roles. Restricting access is possible with one line of code, for example:</p>\n<div class=\"language-rust codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-rust codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[access_control_any(roles(Role::Decrementer))]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">decrement</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token keyword\" style=\"color:#00009f\">mut</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Let’s walk through it step by step to see how you can make your Near smart contract <code>AccessControllable</code>.</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"step-1-add-near-plugins-as-a-dependency\">Step 1: Add <code>near-plugins</code> as a dependency<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#step-1-add-near-plugins-as-a-dependency\" class=\"hash-link\" aria-label=\"Direct link to step-1-add-near-plugins-as-a-dependency\" title=\"Direct link to step-1-add-near-plugins-as-a-dependency\">​</a></h3>\n<p>For now, <code>near-plugins</code> has not yet been published on crates.io. Still, the crate is ready for usage and it can be added as git dependency:</p>\n<div class=\"language-toml codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-toml codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"># Add `near-plugins` under `dependencies` in your Cargo.toml.</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">[dependencies]</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">near-plugins = { git = \"https://github.com/aurora-is-near/near-plugins.git\", tag = \"v0.2.0\" }</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"step-2-define-roles\">Step 2: Define roles<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#step-2-define-roles\" class=\"hash-link\" aria-label=\"Direct link to Step 2: Define roles\" title=\"Direct link to Step 2: Define roles\">​</a></h3>\n<p>Every use case may require a different set of roles, so users may define their roles as variants of an enum. For the <code>Counter</code> example, we define the following roles:</p>\n<div class=\"language-rust codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-rust codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[derive(AccessControlRole, Deserialize, Serialize, Copy, Clone)]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[serde(crate = </span><span class=\"token attribute attr-name string\" style=\"color:#e3116c\">\"near_sdk::serde\"</span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">)]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">enum</span><span class=\"token plain\"> </span><span class=\"token type-definition class-name\">Role</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// Grantees of this role may decrease the counter.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token class-name\">Decrementer</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// Grantees of this role may reset the counter.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token class-name\">Resetter</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Deriving the <code>AccessControlRole</code> trait prepares the <code>Role</code> enum for usage in the <code>AccessControllable</code> plugin.</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"step-3-make-the-contract-accesscontrollable\">Step 3: Make the contract <code>AccessControllable</code><a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#step-3-make-the-contract-accesscontrollable\" class=\"hash-link\" aria-label=\"Direct link to step-3-make-the-contract-accesscontrollable\" title=\"Direct link to step-3-make-the-contract-accesscontrollable\">​</a></h3>\n<p>The contract is made <code>AccessControllable</code> by attaching the <code>access_control</code> attribute macro on the definition of the struct which represents the contract’s state. We pass our <code>Role</code> as argument to make the <code>AccessControllable</code> implementation aware of it:</p>\n<div class=\"language-rust codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-rust codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[access_control(role_type(Role))]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[near_bindgen]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[derive(PanicOnDefault, BorshDeserialize, BorshSerialize)]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">struct</span><span class=\"token plain\"> </span><span class=\"token type-definition class-name\">Counter</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    value</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">i64</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"step-4-restrict-contract-methods\">Step 4: Restrict contract methods<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#step-4-restrict-contract-methods\" class=\"hash-link\" aria-label=\"Direct link to Step 4: Restrict contract methods\" title=\"Direct link to Step 4: Restrict contract methods\">​</a></h3>\n<p>Access to a contract method is restricted by attaching <code>#[access_control_any]</code> and providing the roles to be whitelisted as arguments:</p>\n<div class=\"language-rust codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-rust codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[near_bindgen]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">impl</span><span class=\"token plain\"> </span><span class=\"token class-name\">Counter</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// We must be inside an implementation block with `#[near-bindgen]`.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// Resets the value of the counter to zero.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">///</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// Only accounts that have been granted `Role::Resetter` may successfully call this method.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// If called by an account without this role, the method panics and state remains unchanged.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[access_control_any(roles(Role::Resetter))]</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// enables ACL for this method</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">reset</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token keyword\" style=\"color:#00009f\">mut</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">value </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// By the way, it is also possible to restrict access to accounts that have been granted any of</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// multiple roles. This is how the syntax looks.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[access_control_any(roles(Role::Decrementer, Role::Resetter))]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">no_op</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>Now the contract is set up for access control. The only step that is missing is granting roles to accounts, enabling them to call restricted methods.</p>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"step-5-grant-permissions\">Step 5: Grant permissions<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#step-5-grant-permissions\" class=\"hash-link\" aria-label=\"Direct link to Step 5: Grant permissions\" title=\"Direct link to Step 5: Grant permissions\">​</a></h3>\n<p>In our contract’s constructor method <code>new()</code> we make the contract itself super admin:</p>\n<div class=\"language-rust codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-rust codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token namespace\" style=\"opacity:0.7\">near_sdk</span><span class=\"token namespace punctuation\" style=\"opacity:0.7;color:#393A34\">::</span><span class=\"token macro property\" style=\"color:#36acaa\">require!</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    contract</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">acl_init_super_admin</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token namespace\" style=\"opacity:0.7\">env</span><span class=\"token namespace punctuation\" style=\"opacity:0.7;color:#393A34\">::</span><span class=\"token function\" style=\"color:#d73a49\">current_account_id</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:#e3116c\">\"Failed to initialize super admin\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>The <code>AccessControllable</code> super admin is an admin for every role defined in the <code>Role</code> enum. For this example, it is sufficient to know that a super admin may grant and revoke every role. Making the contract itself super admin facilitates the setup procedure as well as testing. More detailed information on admin roles can be found in the <a href=\"https://github.com/aurora-is-near/near-plugins/blob/master/near-plugins/src/access_controllable.rs\" target=\"_blank\" rel=\"noopener noreferrer\">documentation</a> of the <code>AccessControllable</code> trait.</p>\n<p>To grant the <code>Resetter</code> role to the account <code>alice.near</code>, the contract can call the following function on itself:</p>\n<div class=\"language-rust codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-rust codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token comment\" style=\"color:#999988;font-style:italic\">/// See `AccessControllable::acl_grant_role` for details.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:#d73a49\">acl_grant_role</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token string\" style=\"color:#e3116c\">\"Resetter\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"alice.near\"</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>The <code>AccessControllable</code> trait provides many more methods to administer ACL permissions. After following the steps above, all of them are automatically implemented for a contract using the <code>AccessControllable</code> plugin.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"done\">Done<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#done\" class=\"hash-link\" aria-label=\"Direct link to Done\" title=\"Direct link to Done\">​</a></h2>\n<p>The steps above are sufficient to add complex and configurable ACL permissions to a contract using <code>near-plugins</code>. At this point, <code>alice.near</code> is the only account which has been granted the <code>Resetter</code> role. This means that only <code>alice.near</code> may successfully call the contract’s <code>reset()</code> method.</p>\n<p>The repo contains an <a href=\"https://github.com/mooori/counter-acl-example/blob/main/tests/workflow.rs\" target=\"_blank\" rel=\"noopener noreferrer\">integration test</a> which verifies that <code>AccessControllable</code> was set up correctly for our <code>Counter</code> contract. Take a look at it to learn more about interacting with an <code>AccessControllable</code> contract. To run the test on-chain in a local sandbox, it suffices to clone the repo and execute the following command. This is made possible by <a href=\"https://github.com/near/near-workspaces-rs\" target=\"_blank\" rel=\"noopener noreferrer\">near-workspaces-rs</a>.</p>\n<div class=\"language-undefined codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-undefined codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">cargo test</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"teaser-how-it-works-internally\">Teaser: How it works internally<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#teaser-how-it-works-internally\" class=\"hash-link\" aria-label=\"Direct link to Teaser: How it works internally\" title=\"Direct link to Teaser: How it works internally\">​</a></h2>\n<p>Using <code>AccessControllable</code> extends the contract state to store the permissions that have been granted. Moreover, the <code>AccessControllable</code> trait is implemented for the contract to enable administering permissions. When <code>#[access_control_any(roles(...))]</code> is attached to a method, <code>near-plugin</code> injects code that checks if the caller was granted any of the required roles. If not, a panic is generated which aborts the function call.</p>\n<p>To learn about all the details, you can dive into the <a href=\"https://github.com/aurora-is-near/near-plugins/blob/master/near-plugins-derive/src/access_controllable.rs\" target=\"_blank\" rel=\"noopener noreferrer\">implementation</a> of the <code>AccessControllable</code> macro.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"a-note-on-testing\">A note on testing<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#a-note-on-testing\" class=\"hash-link\" aria-label=\"Direct link to A note on testing\" title=\"Direct link to A note on testing\">​</a></h2>\n<p>The functionality provided by <code>near-plugins</code> is critical for security and we strive to test it exhaustively. In tests, we compile demo contracts for all plugins and deploy them on-chain in a local sandbox. Then we verify that using a particular plugin adds exactly the expected functionality to the contract. These tests and demo contracts can be found <a href=\"https://github.com/aurora-is-near/near-plugins/tree/master/near-plugins-derive/tests\" target=\"_blank\" rel=\"noopener noreferrer\">here</a>.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"ready-for-production-though\">Ready for production, though?<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#ready-for-production-though\" class=\"hash-link\" aria-label=\"Direct link to Ready for production, though?\" title=\"Direct link to Ready for production, though?\">​</a></h2>\n<p>As mentioned earlier, <code>near-plugins</code> comes with the caveat of not yet being published to <em>crates.io</em>. Nevertheless, it is already used in some contracts on mainnet, e.g. contracts related to the <a href=\"https://rainbowbridge.app/transfer\" target=\"_blank\" rel=\"noopener noreferrer\">Rainbow Bridge</a>. Moreover, both <a href=\"https://www.datocms-assets.com/50156/1680101850-hacken-near-plugins-final-report-updated-march2023.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">Hacken</a> and <a href=\"https://www.datocms-assets.com/50156/1680590522-auditone-near-plugins-final-report-updated-march2023.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">AuditOne</a> audited <code>near-plugins</code>, awarding it high scores.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"conclusion\">Conclusion<a href=\"https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near#conclusion\" class=\"hash-link\" aria-label=\"Direct link to Conclusion\" title=\"Direct link to Conclusion\">​</a></h2>\n<p>Using <code>near-plugins</code>, developers can add complex functionality to their smart contracts with just a few lines of code. Developers can focus on creating value for their users by relying on <code>near-plugins</code> for some cumbersome administrative tasks that are nevertheless critical for security. We are testing all plugins extensively and the <code>near-plugins</code> crate has been audited twice. We hope to contribute to the Near ecosystem by providing secure smart contract plugins which developers can build upon.</p>\n<p>This article provides a step-by-step guide to using the <code>AccessControllable</code> plugin. In principle, using other plugins is similar. Head over to the <a href=\"https://github.com/aurora-is-near/near-plugins\" target=\"_blank\" rel=\"noopener noreferrer\">repository</a> and have a look at the documentation and tests to get started with other plugins.</p>",
            "url": "https://doc.aurora.dev/blog/plugins-for-smart-contract-devs-building-on-near",
            "title": "Plugins for smart contract devs building on Near",
            "summary": "Let’s discover how ‘near-plugins’ library could be used by your project, and how it can save you some time during the development of your smart contracts",
            "date_modified": "2024-01-19T00:00:00.000Z",
            "author": {
                "name": "Moritz Zielke"
            },
            "tags": [
                "Tutorials"
            ]
        },
        {
            "id": "https://doc.aurora.dev/blog/contract-callbacks-in-xcc",
            "content_html": "<p>In previous posts, we have written about the cross-contract calls (XCC) feature on Aurora. These include <a href=\"https://doc.aurora.dev/blog/cross-ecosystem-communication\"><em>an overview</em></a>, <a href=\"https://doc.aurora.dev/blog/building-a-game-using-near-aurora-and-bos\"><em>an application</em></a>, and a <a href=\"https://doc.aurora.dev/blog/communication-from-aurora-to-near-local-testing\"><em>deep dive into writing tests</em></a>.</p>\n<p>In this post, we continue with the XCC technical deep dive by discussing in more detail handling XCC results using callbacks. In particular, we focus on the concrete example of needing to refund tokens to a user in the event of an error. Along the way, this example will reveal a bit of a “gotcha” which developers new to the XCC feature may come across, and we’ll discuss how to overcome it.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"the-scenario\">The Scenario<a href=\"https://doc.aurora.dev/blog/contract-callbacks-in-xcc#the-scenario\" class=\"hash-link\" aria-label=\"Direct link to The Scenario\" title=\"Direct link to The Scenario\">​</a></h2>\n<p>This scenario comes from <a href=\"https://github.com/aurora-is-near/aurora-contracts-sdk/tree/76cb2f4f5932b5b9dd887834e1f7528cdeb1837c/examples/ft-refund\" target=\"_blank\" rel=\"noopener noreferrer\"><em>an example</em></a> present in the Aurora Contracts SDK. In the example, we suppose there is a contract for some Near app, A, which works with a <a href=\"https://nomicon.io/Standards/Tokens/FungibleToken/Core\" target=\"_blank\" rel=\"noopener noreferrer\"><em>NEP-141</em></a> token, T, that has also been bridged to Aurora.</p>\n<p>Our goal is to use XCC to allow Aurora users to interact with A using the ERC-20 version of T tokens they have on Aurora. We specifically want to handle the case where if there is an error in A, then the tokens are automatically returned to the user’s address on Aurora.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"the-contracts\">The Contracts<a href=\"https://doc.aurora.dev/blog/contract-callbacks-in-xcc#the-contracts\" class=\"hash-link\" aria-label=\"Direct link to The Contracts\" title=\"Direct link to The Contracts\">​</a></h2>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"the-nep-141-token-t\">The NEP-141 Token T<a href=\"https://doc.aurora.dev/blog/contract-callbacks-in-xcc#the-nep-141-token-t\" class=\"hash-link\" aria-label=\"Direct link to The NEP-141 Token T\" title=\"Direct link to The NEP-141 Token T\">​</a></h3>\n<p>This is a totally standard <a href=\"https://nomicon.io/Standards/Tokens/FungibleToken/Core\" target=\"_blank\" rel=\"noopener noreferrer\"><em>NEP-141</em></a> token done with the <a href=\"https://docs.rs/near-contract-standards/latest/near_contract_standards/fungible_token/index.html\" target=\"_blank\" rel=\"noopener noreferrer\"><em>reference implementation</em></a>. The only thing to say about this is that the mint function is public for the sake of the example.</p>\n<div class=\"language-rust codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-rust codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[near_bindgen]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[derive(BorshSerialize, BorshDeserialize, PanicOnDefault)]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">struct</span><span class=\"token plain\"> </span><span class=\"token type-definition class-name\">Contract</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    name</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">String</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    symbol</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">String</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    decimals</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">u8</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    token</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">FungibleToken</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[near_bindgen]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">impl</span><span class=\"token plain\"> </span><span class=\"token class-name\">Contract</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[init]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">new</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">name</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">String</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> symbol</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">String</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> decimals</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">u8</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">-&gt;</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">Self</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">Self</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            name</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            symbol</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            decimals</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            token</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">FungibleToken</span><span class=\"token punctuation\" style=\"color:#393A34\">::</span><span class=\"token function\" style=\"color:#d73a49\">new</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token string\" style=\"color:#e3116c\">b\"t\"</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">to_vec</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[payable]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">mint</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token keyword\" style=\"color:#00009f\">mut</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> account_id</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">AccountId</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> amount</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#36acaa\">U128</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">token</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">internal_deposit</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token plain\">account_id</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> amount</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">into</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">burn</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token keyword\" style=\"color:#00009f\">mut</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> account_id</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">AccountId</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> amount</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#36acaa\">U128</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">token</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">internal_withdraw</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token plain\">account_id</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> amount</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">into</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token namespace\" style=\"opacity:0.7\">near_contract_standards</span><span class=\"token namespace punctuation\" style=\"opacity:0.7;color:#393A34\">::</span><span class=\"token macro property\" style=\"color:#36acaa\">impl_fungible_token_core!</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token class-name\">Contract</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> token</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token namespace\" style=\"opacity:0.7\">near_contract_standards</span><span class=\"token namespace punctuation\" style=\"opacity:0.7;color:#393A34\">::</span><span class=\"token macro property\" style=\"color:#36acaa\">impl_fungible_token_storage!</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token class-name\">Contract</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> token</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"the-near-app-contract-a\">The Near App Contract A<a href=\"https://doc.aurora.dev/blog/contract-callbacks-in-xcc#the-near-app-contract-a\" class=\"hash-link\" aria-label=\"Direct link to The Near App Contract A\" title=\"Direct link to The Near App Contract A\">​</a></h3>\n<p>This is a very simple contract which only implements the ft_on_transfer function from the NEP-141 spec, thus allowing it to receive T tokens. The implementation of that function is also simple. It either accepts all the tokens or if the attached message is <code>refund</code> then it sends back all the tokens minus a small fee. This “refund” case is what we will focus on since it is in that situation that the returned tokens need to be given back to the user’s address on Aurora.</p>\n<div class=\"language-rust codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-rust codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// A fee that is taken from amounts that are requested to be refunded.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">const</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#36acaa\">FEE</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">u128</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">77</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[near_bindgen]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[derive(BorshDeserialize, BorshSerialize, Default)]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">pub</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">struct</span><span class=\"token plain\"> </span><span class=\"token type-definition class-name\">FtRefund</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token attribute attr-name\" style=\"color:#00a4db\">#[near_bindgen]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">impl</span><span class=\"token plain\"> </span><span class=\"token class-name\">FungibleTokenReceiver</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">for</span><span class=\"token plain\"> </span><span class=\"token class-name\">FtRefund</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">ft_on_transfer</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token keyword\" style=\"color:#00009f\">mut</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">self</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        sender_id</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">AccountId</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        amount</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token constant\" style=\"color:#36acaa\">U128</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        msg</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">String</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">-&gt;</span><span class=\"token plain\"> </span><span class=\"token class-name\">PromiseOrValue</span><span class=\"token operator\" style=\"color:#393A34\">&lt;</span><span class=\"token constant\" style=\"color:#36acaa\">U128</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token keyword\" style=\"color:#00009f\">if</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:#393A34\">&amp;</span><span class=\"token plain\">msg </span><span class=\"token operator\" style=\"color:#393A34\">==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"refund\"</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#00009f\">let</span><span class=\"token plain\"> return_amount </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> amount</span><span class=\"token number\" style=\"color:#36acaa\">.0</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">saturating_sub</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token constant\" style=\"color:#36acaa\">FEE</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token class-name\">PromiseOrValue</span><span class=\"token punctuation\" style=\"color:#393A34\">::</span><span class=\"token class-name\">Value</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token constant\" style=\"color:#36acaa\">U128</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">return_amount</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token class-name\">PromiseOrValue</span><span class=\"token punctuation\" style=\"color:#393A34\">::</span><span class=\"token class-name\">Value</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">into</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<h3 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"the-solidity-contract\">The Solidity Contract<a href=\"https://doc.aurora.dev/blog/contract-callbacks-in-xcc#the-solidity-contract\" class=\"hash-link\" aria-label=\"Direct link to The Solidity Contract\" title=\"Direct link to The Solidity Contract\">​</a></h3>\n<p>This contract uses the XCC feature to allow Aurora users to interact with the Near App Contract. The main entry point is ftTransferCall which takes as input the address of an ERC-20 token bridged from a NEP-141 token, the Near account name of that NEP-141 token, and an amount of tokens. The contract takes the user’s ERC-20 token on Aurora, bridges them back as NEP-141 tokens on its XCC account on Near, and then uses that account to send the NEP-141 tokens to the Near App Contract via <code>ft_transfer_call</code>.</p>\n<div class=\"language-solidity codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-solidity codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token keyword\" style=\"color:#00009f\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">ftTransferCall</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    IEvmErc20 token</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token builtin\">string</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> tokenId</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token builtin\">uint128</span><span class=\"token plain\"> amount</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">public</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    token</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">transferFrom</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">msg</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">sender</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token builtin\">address</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token keyword\" style=\"color:#00009f\">this</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> amount</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    token</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">withdrawToNear</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        abi</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">encodePacked</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">AuroraSdk</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">nearRepresentative</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token builtin\">address</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token keyword\" style=\"color:#00009f\">this</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token builtin\">uint</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">amount</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token builtin\">bytes</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> data </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> abi</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">encodePacked</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:#e3116c\">\"{\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:#e3116c\">'\"receiver_id\": \"'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        nearAccountId</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:#e3116c\">'\",'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:#e3116c\">'\"amount\": \"'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        Strings</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">toString</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">amount</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:#e3116c\">'\",'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:#e3116c\">'\"msg\": \"refund\"'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:#e3116c\">\"}\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    PromiseCreateArgs </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> callFtTransfer </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> near</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">call</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        tokenId</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:#e3116c\">\"ft_transfer_call\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        data</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token number\" style=\"color:#36acaa\">1</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        FT_TRANSFER_CALL_NEAR_GAS</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    PromiseCreateArgs </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> callback </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> near</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">auroraCall</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token builtin\">address</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token keyword\" style=\"color:#00009f\">this</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        abi</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">encodeWithSelector</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:#00009f\">this</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">ftTransferCallCallback</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">selector</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            msg</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">sender</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            tokenId</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            amount</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        CALLBACK_NEAR_GAS</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    callFtTransfer</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">then</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">callback</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">transact</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>There is also a callback for this function which handles the result of that XCC call. The callback is defined in the function ftTransferCallCallback. The logic of this function is to check if there are any tokens that need to be returned to the user on Aurora, and if there are, bridge them back to the user’s address using another ft_transfer_call from the NEP-141 token to Aurora.</p>\n<div class=\"language-solidity codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-solidity codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token keyword\" style=\"color:#00009f\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">ftTransferCallCallback</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token builtin\">address</span><span class=\"token plain\"> sender</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token builtin\">string</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> tokenIdOnNear</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token builtin\">uint128</span><span class=\"token plain\"> amount</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">public</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">onlyRole</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">CALLBACK_ROLE</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    PromiseResult </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> promiseResult </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> AuroraSdk</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">promiseResult</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token builtin\">uint128</span><span class=\"token plain\"> refundAmount </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">promiseResult</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">status </span><span class=\"token operator\" style=\"color:#393A34\">!=</span><span class=\"token plain\"> PromiseResultStatus</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">Successful</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// if Promise failed we need to do whole refund</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        refundAmount </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> amount</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">else</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// else `ft_resolve_transfer` will return used amount of FT,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// which we need to extract from original amount</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token builtin\">uint128</span><span class=\"token plain\"> usedAmount </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">_stringToUint</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token builtin\">string</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">promiseResult</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">output</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        refundAmount </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> amount </span><span class=\"token operator\" style=\"color:#393A34\">-</span><span class=\"token plain\"> usedAmount</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">refundAmount </span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token builtin\">bytes</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> data </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> abi</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">encodePacked</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token string\" style=\"color:#e3116c\">\"{\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token string\" style=\"color:#e3116c\">'\"receiver_id\": \"'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            AuroraSdk</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">currentAccountId</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token string\" style=\"color:#e3116c\">'\",'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token string\" style=\"color:#e3116c\">'\"amount\": \"'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            Strings</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">toString</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">refundAmount</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token string\" style=\"color:#e3116c\">'\",'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token string\" style=\"color:#e3116c\">'\"msg\": \"'</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token function\" style=\"color:#d73a49\">_toHexString</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token builtin\">uint160</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">sender</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">20</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token string\" style=\"color:#e3116c\">'\"}'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        PromiseCreateArgs </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> callFtTransfer </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> near</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">call</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            tokenIdOnNear</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token string\" style=\"color:#e3116c\">\"ft_transfer_call\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            data</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token number\" style=\"color:#36acaa\">1</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            REFUND_NEAR_GAS</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        callFtTransfer</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">transact</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"the-trap\">The Trap<a href=\"https://doc.aurora.dev/blog/contract-callbacks-in-xcc#the-trap\" class=\"hash-link\" aria-label=\"Direct link to The Trap\" title=\"Direct link to The Trap\">​</a></h2>\n<p>So far so good, everything looks straightforward. But this is where we hit a small “gotcha”. The NEP-141 token standard requires attaching 1 yoctoNEAR to ft_transfer_call. This means not only is ftTransferCall spending 1 yoctoNEAR, but so is ftTransferCallCallback in the case that a refund is needed. Someone needs to pay for this cost, and the Aurora Contact SDK <a href=\"https://github.com/aurora-is-near/aurora-contracts-sdk/blob/76cb2f4f5932b5b9dd887834e1f7528cdeb1837c/aurora-solidity-sdk/src/AuroraSdk.sol#L142\" target=\"_blank\" rel=\"noopener noreferrer\"><em>passes that cost on to the caller of the function</em></a>.</p>\n<p>In the case of ftTransferCall, that caller is the user, no problem. But who is the caller in the case of ftTransferCallCallback? One hint comes from the permissions on ftTransferCallCallback. It can only be called by the <code>CALLBACK_ROLE</code>, which is only assigned to the address computed from <code>AuroraSdk.nearRepresentitiveImplicitAddress(address(this))</code>. Therefore this address must approve the Solidity contract to spend its wNEAR in order for it to cover the 1 yoctoNEAR cost in the callback.</p>\n<p>This is the reason for the approveWNEAR function, which is also present in the Solidity contract. It does this approval so that wNEAR can be spent in the callback.</p>\n<div class=\"language-solidity codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-solidity codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token keyword\" style=\"color:#00009f\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">approveWNEAR</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:#00009f\">public</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token builtin\">uint256</span><span class=\"token plain\"> amount </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    PromiseCreateArgs </span><span class=\"token keyword\" style=\"color:#00009f\">memory</span><span class=\"token plain\"> approveCall </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> near</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">auroraCall</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token builtin\">address</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token keyword\" style=\"color:#00009f\">this</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">wNEAR</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        abi</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">encodeWithSelector</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token number\" style=\"color:#36acaa\">0x095ea7b3</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// approve method selector</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            </span><span class=\"token builtin\">address</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token keyword\" style=\"color:#00009f\">this</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">            amount</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        </span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        APPROVE_NEAR_GAS</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    approveCall</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token function\" style=\"color:#d73a49\">transact</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<p>The need for this function is rather quirky. Logically <code>nearRepresentitiveImplicitAddress</code> should be the identity function because it is returning the address on Aurora that corresponds to the XCC account of an Aurora address; meaning that the only way transactions can come from the <code>nearRepresentitiveImplicitAddress(address)</code> is if they were originally sent from the address itself.</p>\n<p>Unfortunately, it is not the identity function because the notion of an implicit Aurora address for any named account on Near was defined long before the XCC feature was invented. The implementation of this is the most natural one: derive the address from the named account the same way addresses are derived from a public key; take the hash and use the last 20 bytes. Composing this implementation with the way XCC accounts are named results in returning a different address than we started with.</p>\n<div class=\"language-rust codeBlockContainer_N8ub theme-code-block\" style=\"--prism-color:#393A34;--prism-background-color:#f6f8fa\"><div class=\"codeBlockContent_aLV6\"><pre tabindex=\"0\" class=\"prism-code language-rust codeBlock_hirX thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_WzCr\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// The XCC account for an Aurora address is a subaccount of Aurora.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">near_representative</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">address</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">Address</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">-&gt;</span><span class=\"token plain\"> </span><span class=\"token class-name\">AccountId</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token macro property\" style=\"color:#36acaa\">format!</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token string\" style=\"color:#e3116c\">\"{}.aurora\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token namespace\" style=\"opacity:0.7\">hex</span><span class=\"token namespace punctuation\" style=\"opacity:0.7;color:#393A34\">::</span><span class=\"token function\" style=\"color:#d73a49\">encode</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">address</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// The implicit address on Aurora of a Near account is derived</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// in the \"obvious\" way.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">aurora_implicit_address</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">account</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">AccountId</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">-&gt;</span><span class=\"token plain\"> </span><span class=\"token class-name\">Address</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:#d73a49\">hash</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">account</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">[</span><span class=\"token number\" style=\"color:#36acaa\">12</span><span class=\"token punctuation\" style=\"color:#393A34\">..</span><span class=\"token number\" style=\"color:#36acaa\">32</span><span class=\"token punctuation\" style=\"color:#393A34\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// Composing these functions logically should be the identity function,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:#999988;font-style:italic\">// but these implementations do not do that unfortunately.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">fn</span><span class=\"token plain\"> </span><span class=\"token function-definition function\" style=\"color:#d73a49\">near_representative_implicit_address</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">address</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token class-name\">Address</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">-&gt;</span><span class=\"token plain\"> </span><span class=\"token class-name\">Address</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">let</span><span class=\"token plain\"> result </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:#d73a49\">aurora_implicit_address</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token function\" style=\"color:#d73a49\">near_representative</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">address</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token macro property\" style=\"color:#36acaa\">debug_assert!</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">result </span><span class=\"token operator\" style=\"color:#393A34\">!=</span><span class=\"token plain\"> address</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    result</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">}</span><br></span></code></pre><div class=\"buttonGroup_YzQc\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_JSbB\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_ilDU\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_pqXq\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"conclusion\">Conclusion<a href=\"https://doc.aurora.dev/blog/contract-callbacks-in-xcc#conclusion\" class=\"hash-link\" aria-label=\"Direct link to Conclusion\" title=\"Direct link to Conclusion\">​</a></h2>\n<p>In conclusion, it is important to remember when working with XCC that there are two addresses which logically correspond to the contract you are working with. One is, of course, the address where the contract is deployed, <code>address(this)</code>. The other is the address which becomes the caller in XCC callbacks, <code>AuroraSdk.nearRepresentitiveImplicitAddress(address(this))</code>. Sometimes it will be important to have a contract “approve itself” when it comes to spending tokens because these two addresses are different.</p>\n<p>To check your understanding of this post, take a look at the full code for this token refund <a href=\"https://github.com/aurora-is-near/aurora-contracts-sdk/tree/76cb2f4f5932b5b9dd887834e1f7528cdeb1837c/examples/ft-refund\" target=\"_blank\" rel=\"noopener noreferrer\"><em>example on GitHub</em></a> and play with it yourself! What happens when you remove <a href=\"https://github.com/aurora-is-near/aurora-contracts-sdk/blob/76cb2f4f5932b5b9dd887834e1f7528cdeb1837c/examples/ft-refund/integration-tests/src/lib.rs#L203C1-L223C47\" target=\"_blank\" rel=\"noopener noreferrer\"><em>the call to approveWNEAR from the integration test</em></a>? What error do you see and why?</p>",
            "url": "https://doc.aurora.dev/blog/contract-callbacks-in-xcc",
            "title": "Contract Callbacks in XCC",
            "summary": "In this post we focus on the need to refund tokens to a user in the event of an error. This will reveal a bit of a “gotcha” which developers new to the XCC may come across, and we’ll discuss how to overcome it",
            "date_modified": "2023-11-17T00:00:00.000Z",
            "author": {
                "name": "Michael Birch"
            },
            "tags": [
                "Tutorials"
            ]
        },
        {
            "id": "https://doc.aurora.dev/blog/practical-erc20-burning",
            "content_html": "<p>Token burning is the act of permanently removing a certain number of tokens from circulation. This article delves into its intricacies and offers guidance based on my real-world experiences at Aurora</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"why-is-there-a-problem\">Why is there a problem?<a href=\"https://doc.aurora.dev/blog/practical-erc20-burning#why-is-there-a-problem\" class=\"hash-link\" aria-label=\"Direct link to Why is there a problem?\" title=\"Direct link to Why is there a problem?\">​</a></h2>\n<p>The ERC20 standard does not inherently specify a token burning mechanism.</p>\n<p>The most common implementation of ERC20 <a href=\"https://docs.openzeppelin.com/contracts/4.x/api/token/erc20?ref=lapitsky.com#ERC20Burnable\" target=\"_blank\" rel=\"noopener noreferrer\">provides</a> <code>ERC20Burnable</code> to solve that, but not all deployed OpenZepellin contracts include <code>ERC20Burnable</code>. Many ERC20 contracts are locked and not upgradeable.</p>\n<p>Due to these constraints, projects seek alternative ways to approach token burns.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"do-not-use-contract-burns\">Do not use contract burns<a href=\"https://doc.aurora.dev/blog/practical-erc20-burning#do-not-use-contract-burns\" class=\"hash-link\" aria-label=\"Direct link to Do not use contract burns\" title=\"Direct link to Do not use contract burns\">​</a></h2>\n<p>One often recommended way to burn tokens involves creating a contract that immediately self-destructs and sends tokens to its own address. However, this method comes with its set of challenges:</p>\n<ul>\n<li>The overhead of creating, deploying, and testing such contracts, especially if the burn needs to happen periodically</li>\n<li>Even if the contract uses <code>SELFDESTRUCT</code> it does not preclude the possibility of redeploying another contract at the same address. This has been successfully exploited in the infamous <a href=\"https://forum.tornado.ws/t/full-governance-attack-description/62?ref=lapitsky.com\" target=\"_blank\" rel=\"noopener noreferrer\">Tornado Cash attack</a> by using a metamorphic contract factory.</li>\n<li>There is a negative sentiment against <code>SELFDESTRUCT</code> opcode and (although stagnant) <a href=\"https://eips.ethereum.org/EIPS/eip-4758?ref=lapitsky.com\" target=\"_blank\" rel=\"noopener noreferrer\">EIP-4758</a> that highlights some security concerns.</li>\n<li>Token burns via this method aren't recognized on most analytics platforms.</li>\n</ul>\n<p>Given the listed concerns, I advise against this approach and encourage the use of burn addresses.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"use-well-known-burn-addresses\">Use well-known burn addresses<a href=\"https://doc.aurora.dev/blog/practical-erc20-burning#use-well-known-burn-addresses\" class=\"hash-link\" aria-label=\"Direct link to Use well-known burn addresses\" title=\"Direct link to Use well-known burn addresses\">​</a></h2>\n<p>A burn address is a recognized externally owned account (<a href=\"https://ethereum.org/en/whitepaper/?ref=lapitsky.com#ethereum-accounts\" target=\"_blank\" rel=\"noopener noreferrer\">EOA</a>) where tokens can be sent to symbolize their destruction. While the token count remains unchanged, these tokens are effectively removed from circulation since no private key can control the burn address.</p>\n<p>One of the common questions is \"What if somebody knows or brute forces the private keys for such EOA addresses?\"</p>\n<p>Ethereum security model rests on the practical impossibility of brute forcing EOA accounts, so it does not make sense to take the risk of such an attack into account when planning the burns. To mitigate the risk of malicious burn addresses, use only the well-known ones.</p>\n<p>You can find the list of burn addresses on <a href=\"https://etherscan.io/accounts/label/burn?ref=lapitsky.com\" target=\"_blank\" rel=\"noopener noreferrer\">Etherscan</a> but I recommend limiting it to the top two that stand out by the TVL and number of transactions: <code>0x0000000000000000000000000000000000000000</code> (<em>null</em>) and <code>0x000000000000000000000000000000000000dEaD</code> (<em>dead</em>).</p>\n<p>Interestingly, OpenZeppelin's ERC20 implementation restricts transfers to <em>null</em> which could leave you with the second-best choice: <em>dead.</em></p>\n<p>The benefit of using well-known burn addresses over \"contract burns\" is that burn addresses are accounted for and integrated into numerous analytics tools, ensuring accurate token burn data representation.</p>\n<h2 class=\"anchor anchorWithStickyNavbar_L_jL\" id=\"bonus-tips\">Bonus tips<a href=\"https://doc.aurora.dev/blog/practical-erc20-burning#bonus-tips\" class=\"hash-link\" aria-label=\"Direct link to Bonus tips\" title=\"Direct link to Bonus tips\">​</a></h2>\n<ul>\n<li>Ensure that your ERC20 contract is locked and immutable before initiating burns.</li>\n<li>For ERC20 tokens on multiple networks, execute burns on your primary network only, for unified tracking and analytics.</li>\n<li>For the first burn, refrain from using decentralized or ZK-bridges. If your contract unexpectedly rejects the transaction (like disallowing transfers to <em>null</em>) – it might muddle your analytics even though the tokens are technically burned.</li>\n</ul>\n<p>Big thanks to <a href=\"https://www.linkedin.com/in/lance-henderson/?ref=lapitsky.com\" target=\"_blank\" rel=\"noopener noreferrer\">Lance Henderson</a> for technical insights and for reviewing this post!</p>",
            "url": "https://doc.aurora.dev/blog/practical-erc20-burning",
            "title": "Practical ERC20 Burning",
            "summary": "Token burning is the act of permanently removing a certain number of tokens from circulation. This article delves into its intricacies and offers guidance based on my real-world experiences at Aurora",
            "date_modified": "2023-09-22T00:00:00.000Z",
            "author": {
                "name": "Alexey Lapitsky"
            },
            "tags": [
                "Tips & Tricks"
            ]
        }
    ]
}